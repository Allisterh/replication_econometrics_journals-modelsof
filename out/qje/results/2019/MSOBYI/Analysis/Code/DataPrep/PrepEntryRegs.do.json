[
  {
    "id": "comment",
    "value": "/* PrepEntryRegs.do */",
    "line": 1,
    "column": 1
  },
  {
    "id": "comment",
    "value": "* This file takes the prepped household-by-quarter Homescan data and merges in the store entry dataset.",
    "line": 2,
    "column": 1
  },
  {
    "id": "comment",
    "value": "* It then takes the prepped household-by-year Homescan data and merges the ZPB supply dataset",
    "line": 3,
    "column": 1
  },
  {
    "id": "comment",
    "value": "// \"308 408 508 608 612 412\"",
    "line": 5,
    "column": 31
  },
  {
    "command": {
      "id": "identifier",
      "value": "global",
      "line": 5,
      "column": 1
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "WindowList",
        "line": 5,
        "column": 8
      }
    ],
    "=": [
      {
        "id": "string",
        "value": "\"408 808\"",
        "line": 5,
        "column": 21
      }
    ]
  },
  {
    "id": "comment",
    "value": "// 015 // \"S\" for Supercenters",
    "line": 6,
    "column": 24
  },
  {
    "command": {
      "id": "identifier",
      "value": "global",
      "line": 6,
      "column": 1
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "dlist",
        "line": 6,
        "column": 8
      }
    ],
    "=": [
      {
        "id": "string",
        "value": "\"15 10\"",
        "line": 6,
        "column": 16
      }
    ]
  },
  {
    "id": "comment",
    "value": "/* MERGE INTO QUARTERLY TRANSACTIONS DATA */",
    "line": 10,
    "column": 1
  },
  {
    "id": "comment",
    "value": "// HHxQuarter_Magnet",
    "line": 11,
    "column": 33
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 11,
      "column": 1
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "dataset",
        "line": 11,
        "column": 9
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "HHxQuarter",
        "line": 11,
        "column": 20
      },
      {
        "id": "{",
        "value": "{",
        "line": 11,
        "column": 31
      }
    ]
  },
  {
    "id": "comment",
    "value": "// MilkFatPct Whole FreshProduce",
    "line": 13,
    "column": 152
  },
  {
    "command": {
      "id": "identifier",
      "value": "use",
      "line": 12,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "household_code",
        "line": 12,
        "column": 6
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 12,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "Calories",
        "line": 12,
        "column": 24
      },
      {
        "id": "identifier",
        "value": "expshare_Grocery",
        "line": 12,
        "column": 33
      },
      {
        "id": "identifier",
        "value": "expshare_ChainGroc",
        "line": 12,
        "column": 50
      },
      {
        "id": "identifier",
        "value": "expshare_Mass",
        "line": 12,
        "column": 69
      },
      {
        "id": "identifier",
        "value": "expshare_Club",
        "line": 12,
        "column": 83
      },
      {
        "id": "identifier",
        "value": "expshare_Super",
        "line": 12,
        "column": 97
      },
      {
        "id": "identifier",
        "value": "expshare_DrugConv",
        "line": 12,
        "column": 112
      },
      {
        "id": "identifier",
        "value": "Produce",
        "line": 13,
        "column": 3
      },
      {
        "id": "identifier",
        "value": "lHEI_per1000Cal",
        "line": 13,
        "column": 11
      },
      {
        "id": "identifier",
        "value": "HEI_per1000Cal",
        "line": 13,
        "column": 27
      },
      {
        "id": "identifier",
        "value": "HealthIndex_per1000Cal",
        "line": 13,
        "column": 42
      },
      {
        "id": "identifier",
        "value": "InSample",
        "line": 13,
        "column": 65
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 13,
        "column": 74
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 13,
        "column": 80
      },
      {
        "id": "/",
        "value": "/",
        "line": 13,
        "column": 90
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 13,
        "column": 91
      },
      {
        "id": "/",
        "value": "/",
        "line": 13,
        "column": 103
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 13,
        "column": 104
      },
      {
        "id": "/",
        "value": "/",
        "line": 13,
        "column": 112
      },
      {
        "id": "`'",
        "value": "`dataset'",
        "line": 13,
        "column": 113
      },
      {
        "id": "identifier",
        "value": ".dta",
        "line": 13,
        "column": 122
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "InSample",
        "line": 13,
        "column": 140
      },
      {
        "id": "==",
        "value": "==",
        "line": 13,
        "column": 148
      },
      {
        "id": "number",
        "value": "1",
        "line": 13,
        "column": 150
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "replace",
        "line": 13,
        "column": 128
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "drop",
      "line": 14,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "InSample",
        "line": 14,
        "column": 7
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 15,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "int",
        "line": 15,
        "column": 6
      },
      {
        "id": "identifier",
        "value": "panel_year",
        "line": 15,
        "column": 10
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "year",
        "line": 15,
        "column": 23
      },
      {
        "id": "identifier",
        "value": "dofq",
        "line": 15,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 15,
        "column": 33
      }
    ]
  },
  {
    "id": "comment",
    "value": "* Implied expenditure shares",
    "line": 17,
    "column": 3
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 18,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_SuperClub",
        "line": 18,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "expshare_Super",
        "line": 18,
        "column": 28
      },
      {
        "id": "+",
        "value": "+",
        "line": 18,
        "column": 42
      },
      {
        "id": "identifier",
        "value": "expshare_Club",
        "line": 18,
        "column": 43
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 19,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_OtherMass",
        "line": 19,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "expshare_Mass",
        "line": 19,
        "column": 28
      },
      {
        "id": "-",
        "value": "-",
        "line": 19,
        "column": 41
      },
      {
        "id": "identifier",
        "value": "expshare_SuperClub",
        "line": 19,
        "column": 42
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 20,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_CSC",
        "line": 20,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "expshare_ChainGroc",
        "line": 20,
        "column": 22
      },
      {
        "id": "+",
        "value": "+",
        "line": 20,
        "column": 40
      },
      {
        "id": "identifier",
        "value": "expshare_SuperClub",
        "line": 20,
        "column": 41
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 21,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_GSC",
        "line": 21,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "expshare_Grocery",
        "line": 21,
        "column": 22
      },
      {
        "id": "+",
        "value": "+",
        "line": 21,
        "column": 38
      },
      {
        "id": "identifier",
        "value": "expshare_SuperClub",
        "line": 21,
        "column": 39
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 22,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_NonChainGroc",
        "line": 22,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "expshare_Grocery",
        "line": 22,
        "column": 31
      },
      {
        "id": "-",
        "value": "-",
        "line": 22,
        "column": 47
      },
      {
        "id": "identifier",
        "value": "expshare_ChainGroc",
        "line": 22,
        "column": 48
      }
    ]
  },
  {
    "id": "comment",
    "value": "*gen expshare_ChainSuper = expshare_Super+expshare_ChainGroc",
    "line": 24,
    "column": 3
  },
  {
    "id": "comment",
    "value": "* Alternative expshares moving Walmart and Target to the Entrant and Supercenter categories (it appears that some Walmart and Target supercenters are miscategorized in Homescan retailer codes as being regular)",
    "line": 25,
    "column": 3
  },
  {
    "id": "comment",
    "value": "*foreach channel in SuperClub Entrant CSC GSC {",
    "line": 26,
    "column": 3
  },
  {
    "id": "comment",
    "value": "*\tgen expshare_A`channel' = expshare_`channel' + expshare_WalTar",
    "line": 27,
    "column": 3
  },
  {
    "id": "comment",
    "value": "*}\t\t",
    "line": 28,
    "column": 3
  },
  {
    "id": "comment",
    "value": "** Merge household data",
    "line": 30,
    "column": 2
  },
  {
    "id": "comment",
    "value": "/*\n\t\tif \"`dataset'\" == \"HHxQuarter\" {\n\t\t\tlocal pf = \"projection_factor\"\n\t\t}\n\t\tif \"`dataset'\" == \"HHxQuarter_Magnet\" {\n\t\t\tlocal pf = \"projection_factor_magnet\"\n\t\t}\n\t\t*/",
    "line": 31,
    "column": 3
  },
  {
    "id": "comment",
    "value": "// `pf'",
    "line": 33,
    "column": 135
  },
  {
    "command": {
      "id": "identifier",
      "value": "merge",
      "line": 32,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "m",
        "line": 32,
        "column": 8
      },
      {
        "id": ":",
        "value": ":",
        "line": 32,
        "column": 9
      },
      {
        "id": "number",
        "value": "1",
        "line": 32,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 32,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "panel_year",
        "line": 32,
        "column": 27
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 32,
        "column": 38
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 32,
        "column": 44
      },
      {
        "id": "/",
        "value": "/",
        "line": 32,
        "column": 54
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 32,
        "column": 55
      },
      {
        "id": "/",
        "value": "/",
        "line": 32,
        "column": 67
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 32,
        "column": 68
      },
      {
        "id": "/",
        "value": "/",
        "line": 32,
        "column": 76
      },
      {
        "id": "identifier",
        "value": "Prepped",
        "line": 32,
        "column": 77
      },
      {
        "id": "-",
        "value": "-",
        "line": 32,
        "column": 84
      },
      {
        "id": "identifier",
        "value": "Household",
        "line": 32,
        "column": 85
      },
      {
        "id": "-",
        "value": "-",
        "line": 32,
        "column": 94
      },
      {
        "id": "identifier",
        "value": "Panel.dta",
        "line": 32,
        "column": 95
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "nogen",
        "line": 33,
        "column": 3
      },
      {
        "id": "identifier",
        "value": "keep",
        "line": 33,
        "column": 9
      },
      {
        "id": "identifier",
        "value": "match",
        "line": 33,
        "column": 14
      },
      {
        "id": "identifier",
        "value": "master",
        "line": 33,
        "column": 20
      },
      {
        "id": "identifier",
        "value": "keepusing",
        "line": 33,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "FirstYearInZip",
        "line": 33,
        "column": 38
      },
      {
        "id": "identifier",
        "value": "HMS_Location_ID",
        "line": 33,
        "column": 53
      },
      {
        "id": "identifier",
        "value": "CTractGroup",
        "line": 33,
        "column": 69
      },
      {
        "id": "identifier",
        "value": "zip_code",
        "line": 33,
        "column": 81
      },
      {
        "id": "identifier",
        "value": "region_code",
        "line": 33,
        "column": 90
      },
      {
        "id": "identifier",
        "value": "IncomeResidQuartile",
        "line": 33,
        "column": 102
      },
      {
        "id": "identifier",
        "value": "$Ctls_Merge",
        "line": 33,
        "column": 122
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Merge the store entry data",
    "line": 35,
    "column": 2
  },
  {
    "id": "comment",
    "value": "// CountEntryt_RetObs_1?  PostEntry_5 PostEntry_10",
    "line": 37,
    "column": 115
  },
  {
    "command": {
      "id": "identifier",
      "value": "merge",
      "line": 36,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "m",
        "line": 36,
        "column": 8
      },
      {
        "id": ":",
        "value": ":",
        "line": 36,
        "column": 9
      },
      {
        "id": "number",
        "value": "1",
        "line": 36,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "HMS_Location_ID",
        "line": 36,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 36,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 36,
        "column": 31
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 36,
        "column": 37
      },
      {
        "id": "/",
        "value": "/",
        "line": 36,
        "column": 47
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 36,
        "column": 48
      },
      {
        "id": "/",
        "value": "/",
        "line": 36,
        "column": 60
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 36,
        "column": 61
      },
      {
        "id": "/",
        "value": "/",
        "line": 36,
        "column": 69
      },
      {
        "id": "identifier",
        "value": "HomescanLatLongwithStoreEntry.dta",
        "line": 36,
        "column": 70
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "keep",
        "line": 36,
        "column": 105
      },
      {
        "id": "identifier",
        "value": "match",
        "line": 36,
        "column": 110
      },
      {
        "id": "identifier",
        "value": "master",
        "line": 36,
        "column": 116
      },
      {
        "id": "identifier",
        "value": "nogen",
        "line": 36,
        "column": 124
      },
      {
        "id": "identifier",
        "value": "keepusing",
        "line": 37,
        "column": 3
      },
      {
        "id": "*",
        "value": "*",
        "line": 37,
        "column": 13
      },
      {
        "id": "identifier",
        "value": "PostEntryt_??",
        "line": 37,
        "column": 14
      },
      {
        "id": "identifier",
        "value": "CountEntryt_??",
        "line": 37,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "CountEntryt_S_??",
        "line": 37,
        "column": 43
      },
      {
        "id": "identifier",
        "value": "Entrantt_retailer_code_??",
        "line": 37,
        "column": 60
      },
      {
        "id": "identifier",
        "value": "Entrantt_S_retailer_code_??",
        "line": 37,
        "column": 86
      }
    ]
  },
  {
    "id": "comment",
    "value": "* Merge subchannel",
    "line": 39,
    "column": 2
  },
  {
    "id": "comment",
    "value": "/*\n\tforeach d in $dlist {\n\t\tgen store_code = Entrantt_store_code_`d'\n\t\tmerge m:1 store_code using $Externals/Calculations/StoreEntryExit/AllRetailerEntry.dta, keep(match master) keepusing(subchannel) nogen\n\t\trename subchannel subchannel_`d'\n\t\tdrop store_code\n\t}\n\t*/",
    "line": 40,
    "column": 2
  },
  {
    "id": "comment",
    "value": "** Generate the 0-15 minute data",
    "line": 42,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "if",
      "line": 43,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "strpos",
        "line": 43,
        "column": 5
      },
      {
        "id": "string",
        "value": "\"$dlist\"",
        "line": 43,
        "column": 12
      },
      {
        "id": ",",
        "value": ",",
        "line": 43,
        "column": 20
      },
      {
        "id": "string",
        "value": "\"015\"",
        "line": 43,
        "column": 21
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 43,
        "column": 27
      },
      {
        "id": "number",
        "value": "0",
        "line": 43,
        "column": 29
      },
      {
        "id": "{",
        "value": "{",
        "line": 43,
        "column": 31
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "forvalues",
      "line": 44,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "q",
        "line": 44,
        "column": 13
      }
    ],
    "=": [
      {
        "id": "number",
        "value": "2",
        "line": 44,
        "column": 17
      },
      {
        "id": "/",
        "value": "/",
        "line": 44,
        "column": 18
      },
      {
        "id": "number",
        "value": "23",
        "line": 44,
        "column": 19
      },
      {
        "id": "{",
        "value": "{",
        "line": 44,
        "column": 22
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 45,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Q",
        "line": 45,
        "column": 8
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 45,
        "column": 9
      },
      {
        "id": "identifier",
        "value": "PostEntryt_015",
        "line": 45,
        "column": 12
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "Q",
        "line": 45,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 45,
        "column": 30
      },
      {
        "id": "identifier",
        "value": "PostEntryt_10",
        "line": 45,
        "column": 33
      },
      {
        "id": "+",
        "value": "+",
        "line": 45,
        "column": 46
      },
      {
        "id": "identifier",
        "value": "Q",
        "line": 45,
        "column": 47
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 45,
        "column": 48
      },
      {
        "id": "identifier",
        "value": "PostEntryt_15",
        "line": 45,
        "column": 51
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 47,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "CountEntryt_015",
        "line": 47,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "CountEntryt_10",
        "line": 47,
        "column": 25
      },
      {
        "id": "+",
        "value": "+",
        "line": 47,
        "column": 39
      },
      {
        "id": "identifier",
        "value": "CountEntryt_15",
        "line": 47,
        "column": 40
      }
    ]
  },
  {
    "id": "comment",
    "value": "*** Merge expenditures across all entrant stores",
    "line": 50,
    "column": 2
  },
  {
    "id": "comment",
    "value": "** Get a list of entering store and retailer codes for each household",
    "line": 51,
    "column": 2
  },
  {
    "id": "comment",
    "value": "// store",
    "line": 52,
    "column": 29
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 52,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "code",
        "line": 52,
        "column": 10
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "retailer",
        "line": 52,
        "column": 18
      },
      {
        "id": "{",
        "value": "{",
        "line": 52,
        "column": 27
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 53,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "time",
        "line": 53,
        "column": 11
      }
    ],
    "in": [
      {
        "id": "number",
        "value": "10",
        "line": 53,
        "column": 19
      },
      {
        "id": "number",
        "value": "15",
        "line": 53,
        "column": 22
      },
      {
        "id": "{",
        "value": "{",
        "line": 53,
        "column": 25
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 54,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "u",
        "line": 54,
        "column": 12
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "t",
        "line": 54,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "t_S",
        "line": 54,
        "column": 19
      },
      {
        "id": "{",
        "value": "{",
        "line": 54,
        "column": 23
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "preserve",
      "line": 55,
      "column": 5
    }
  },
  {
    "command": {
      "id": "identifier",
      "value": "keep",
      "line": 56,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "household_code",
        "line": 56,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "Entrant",
        "line": 56,
        "column": 25
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 56,
        "column": 32
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 56,
        "column": 35
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 56,
        "column": 36
      },
      {
        "id": "identifier",
        "value": "_code_",
        "line": 56,
        "column": 42
      },
      {
        "id": "`'",
        "value": "`time'",
        "line": 56,
        "column": 48
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "drop",
      "line": 57,
      "column": 5
    },
    "if": [
      {
        "id": "identifier",
        "value": "Entrant",
        "line": 57,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 57,
        "column": 20
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 57,
        "column": 23
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 57,
        "column": 24
      },
      {
        "id": "identifier",
        "value": "_code_",
        "line": 57,
        "column": 30
      },
      {
        "id": "`'",
        "value": "`time'",
        "line": 57,
        "column": 36
      },
      {
        "id": "==",
        "value": "==",
        "line": 57,
        "column": 42
      },
      {
        "id": "identifier",
        "value": ".",
        "line": 57,
        "column": 44
      }
    ]
  },
  {
    "id": "comment",
    "value": "// In some cases a household has two different stores from the same retailer enter; drop these duplicates so we don't double-count these expenditures",
    "line": 58,
    "column": 21
  },
  {
    "command": {
      "id": "identifier",
      "value": "duplicates",
      "line": 58,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "drop",
        "line": 58,
        "column": 16
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "rename",
      "line": 59,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Entrant",
        "line": 59,
        "column": 12
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 59,
        "column": 19
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 59,
        "column": 22
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 59,
        "column": 23
      },
      {
        "id": "identifier",
        "value": "_code_",
        "line": 59,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`time'",
        "line": 59,
        "column": 35
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 59,
        "column": 42
      },
      {
        "id": "identifier",
        "value": "_code",
        "line": 59,
        "column": 48
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 60,
      "column": 28
    },
    "pre": [
      {
        "command": {
          "id": "identifier",
          "value": "bysort",
          "line": 60,
          "column": 5
        },
        "varlist": [
          {
            "id": "identifier",
            "value": "household_code",
            "line": 60,
            "column": 12
          }
        ]
      }
    ],
    "varlist": [
      {
        "id": "identifier",
        "value": "n",
        "line": 60,
        "column": 32
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "_n",
        "line": 60,
        "column": 34
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "reshape",
      "line": 61,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "wide",
        "line": 61,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 61,
        "column": 18
      },
      {
        "id": "identifier",
        "value": "_code",
        "line": 61,
        "column": 24
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "i",
        "line": 61,
        "column": 31
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 61,
        "column": 33
      },
      {
        "id": "identifier",
        "value": "j",
        "line": 61,
        "column": 49
      },
      {
        "id": "identifier",
        "value": "n",
        "line": 61,
        "column": 51
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "saveold",
      "line": 62,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 62,
        "column": 13
      },
      {
        "id": "/",
        "value": "/",
        "line": 62,
        "column": 23
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 62,
        "column": 24
      },
      {
        "id": "/",
        "value": "/",
        "line": 62,
        "column": 36
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 62,
        "column": 37
      },
      {
        "id": "/",
        "value": "/",
        "line": 62,
        "column": 45
      },
      {
        "id": "identifier",
        "value": "Temp_",
        "line": 62,
        "column": 46
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 62,
        "column": 51
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 62,
        "column": 57
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 62,
        "column": 58
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 62,
        "column": 61
      },
      {
        "id": "`'",
        "value": "`time'",
        "line": 62,
        "column": 62
      },
      {
        "id": "identifier",
        "value": ".dta",
        "line": 62,
        "column": 68
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "replace",
        "line": 62,
        "column": 74
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "restore",
      "line": 63,
      "column": 5
    }
  },
  {
    "id": "comment",
    "value": "** Merge those entries",
    "line": 69,
    "column": 2
  },
  {
    "id": "comment",
    "value": "// store",
    "line": 70,
    "column": 29
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 70,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "code",
        "line": 70,
        "column": 10
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "retailer",
        "line": 70,
        "column": 18
      },
      {
        "id": "{",
        "value": "{",
        "line": 70,
        "column": 27
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 71,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "u",
        "line": 71,
        "column": 11
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "t",
        "line": 71,
        "column": 16
      },
      {
        "id": "identifier",
        "value": "t_S",
        "line": 71,
        "column": 18
      },
      {
        "id": "{",
        "value": "{",
        "line": 71,
        "column": 22
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 72,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_E",
        "line": 72,
        "column": 8
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 72,
        "column": 18
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 72,
        "column": 21
      }
    ],
    "=": [
      {
        "id": "number",
        "value": "0",
        "line": 72,
        "column": 30
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 74,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "time",
        "line": 74,
        "column": 12
      }
    ],
    "in": [
      {
        "id": "number",
        "value": "10",
        "line": 74,
        "column": 20
      },
      {
        "id": "number",
        "value": "15",
        "line": 74,
        "column": 23
      },
      {
        "id": "{",
        "value": "{",
        "line": 74,
        "column": 26
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "merge",
      "line": 75,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "m",
        "line": 75,
        "column": 11
      },
      {
        "id": ":",
        "value": ":",
        "line": 75,
        "column": 12
      },
      {
        "id": "number",
        "value": "1",
        "line": 75,
        "column": 13
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 75,
        "column": 15
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 75,
        "column": 30
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 75,
        "column": 36
      },
      {
        "id": "/",
        "value": "/",
        "line": 75,
        "column": 46
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 75,
        "column": 47
      },
      {
        "id": "/",
        "value": "/",
        "line": 75,
        "column": 59
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 75,
        "column": 60
      },
      {
        "id": "/",
        "value": "/",
        "line": 75,
        "column": 68
      },
      {
        "id": "identifier",
        "value": "Temp_",
        "line": 75,
        "column": 69
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 75,
        "column": 74
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 75,
        "column": 80
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 75,
        "column": 81
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 75,
        "column": 84
      },
      {
        "id": "`'",
        "value": "`time'",
        "line": 75,
        "column": 85
      },
      {
        "id": "identifier",
        "value": ".dta",
        "line": 75,
        "column": 91
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "nogen",
        "line": 76,
        "column": 6
      },
      {
        "id": "identifier",
        "value": "keep",
        "line": 76,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "match",
        "line": 76,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "master",
        "line": 76,
        "column": 23
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Get expenditures for each entry and add to the expshare_E variable",
    "line": 77,
    "column": 5
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 78,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 78,
        "column": 13
      },
      {
        "id": "identifier",
        "value": "of",
        "line": 78,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "varlist",
        "line": 78,
        "column": 20
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 78,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "_code",
        "line": 78,
        "column": 34
      },
      {
        "id": "*",
        "value": "*",
        "line": 78,
        "column": 39
      },
      {
        "id": "{",
        "value": "{",
        "line": 78,
        "column": 41
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "rename",
      "line": 79,
      "column": 6
    },
    "varlist": [
      {
        "id": "`'",
        "value": "`var'",
        "line": 79,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 79,
        "column": 19
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 79,
        "column": 25
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "merge",
      "line": 80,
      "column": 6
    },
    "varlist": [
      {
        "id": "number",
        "value": "1",
        "line": 80,
        "column": 12
      },
      {
        "id": ":",
        "value": ":",
        "line": 80,
        "column": 13
      },
      {
        "id": "number",
        "value": "1",
        "line": 80,
        "column": 14
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 80,
        "column": 16
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 80,
        "column": 31
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 80,
        "column": 34
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 80,
        "column": 40
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 80,
        "column": 49
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 80,
        "column": 55
      },
      {
        "id": "/",
        "value": "/",
        "line": 80,
        "column": 65
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 80,
        "column": 66
      },
      {
        "id": "/",
        "value": "/",
        "line": 80,
        "column": 78
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 80,
        "column": 79
      },
      {
        "id": "/",
        "value": "/",
        "line": 80,
        "column": 87
      },
      {
        "id": "identifier",
        "value": "HHxQuarterx",
        "line": 80,
        "column": 88
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 80,
        "column": 99
      },
      {
        "id": "identifier",
        "value": ".dta",
        "line": 80,
        "column": 105
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "keep",
        "line": 81,
        "column": 7
      },
      {
        "id": "identifier",
        "value": "match",
        "line": 81,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "master",
        "line": 81,
        "column": 18
      },
      {
        "id": "identifier",
        "value": "keepusing",
        "line": 81,
        "column": 26
      },
      {
        "id": "identifier",
        "value": "expshare",
        "line": 81,
        "column": 36
      },
      {
        "id": "identifier",
        "value": "nogen",
        "line": 81,
        "column": 46
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 82,
      "column": 6
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_E",
        "line": 82,
        "column": 14
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 82,
        "column": 24
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 82,
        "column": 27
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "expshare_E",
        "line": 82,
        "column": 36
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 82,
        "column": 46
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 82,
        "column": 49
      },
      {
        "id": "+",
        "value": "+",
        "line": 82,
        "column": 56
      },
      {
        "id": "identifier",
        "value": "expshare",
        "line": 82,
        "column": 58
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "expshare",
        "line": 82,
        "column": 70
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 82,
        "column": 78
      },
      {
        "id": "identifier",
        "value": ".",
        "line": 82,
        "column": 80
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "drop",
      "line": 83,
      "column": 6
    },
    "varlist": [
      {
        "id": "`'",
        "value": "`code'",
        "line": 83,
        "column": 11
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 83,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "expshare",
        "line": 83,
        "column": 26
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "erase",
      "line": 85,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 85,
        "column": 11
      },
      {
        "id": "/",
        "value": "/",
        "line": 85,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 85,
        "column": 22
      },
      {
        "id": "/",
        "value": "/",
        "line": 85,
        "column": 34
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 85,
        "column": 35
      },
      {
        "id": "/",
        "value": "/",
        "line": 85,
        "column": 43
      },
      {
        "id": "identifier",
        "value": "Temp_",
        "line": 85,
        "column": 44
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 85,
        "column": 49
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 85,
        "column": 55
      },
      {
        "id": "`'",
        "value": "`u'",
        "line": 85,
        "column": 56
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 85,
        "column": 59
      },
      {
        "id": "`'",
        "value": "`time'",
        "line": 85,
        "column": 60
      },
      {
        "id": "identifier",
        "value": ".dta",
        "line": 85,
        "column": 66
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Rename variables for estimates",
    "line": 89,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "rename",
      "line": 90,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_Etretailer",
        "line": 90,
        "column": 9
      },
      {
        "id": "identifier",
        "value": "expshare_Eretailer",
        "line": 90,
        "column": 29
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "rename",
      "line": 91,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_Et_Sretailer",
        "line": 91,
        "column": 9
      },
      {
        "id": "identifier",
        "value": "expshare_ESretailer",
        "line": 91,
        "column": 31
      }
    ]
  },
  {
    "id": "comment",
    "value": "*****************************",
    "line": 93,
    "column": 2
  },
  {
    "id": "comment",
    "value": "/*\n\t* tk temp: merge Walmart expenditures\n\tforeach retailer in 6905 6920 {\n\t\tgen expshare_`retailer' = 0\n\t\tgen retailer_code_uc = `retailer'\n\t\tmerge 1:1 household_code YQ retailer_code_uc using $Externals/Calculations/Homescan/HHxQuarterxretailer.dta, ///\n\t\t\tkeep(match master) keepusing(expshare) nogen\n\t\treplace expshare_`retailer' = expshare if expshare!=.\n\t\tdrop retailer_code_uc expshare\n\t}\n\tgen expshare_Wal = expshare_6905+expshare_6920\n\t\n\t*\n\t*/",
    "line": 94,
    "column": 2
  },
  {
    "id": "comment",
    "value": "******************************",
    "line": 95,
    "column": 2
  },
  {
    "id": "comment",
    "value": "** Merge zip code supply characteristics as of each household's first year in the zip",
    "line": 97,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 98,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "int",
        "line": 98,
        "column": 6
      },
      {
        "id": "identifier",
        "value": "year",
        "line": 98,
        "column": 10
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "FirstYearInZip",
        "line": 98,
        "column": 17
      }
    ]
  },
  {
    "id": "comment",
    "value": "//  ",
    "line": 99,
    "column": 203
  },
  {
    "command": {
      "id": "identifier",
      "value": "local",
      "line": 99,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "ZipChars",
        "line": 99,
        "column": 8
      }
    ],
    "=": [
      {
        "id": "string",
        "value": "\"meanHealthIndex NProduceUPCs lnNProduceUPCs est_Large est_LargeGroc est_SuperClub meanHealthIndex_3m NProduceUPCs_3m lnNProduceUPCs_3m est_Large_3m est_LargeGroc_3m est_SuperClub_3m\"",
        "line": 99,
        "column": 19
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "merge",
      "line": 100,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "m",
        "line": 100,
        "column": 8
      },
      {
        "id": ":",
        "value": ":",
        "line": 100,
        "column": 9
      },
      {
        "id": "number",
        "value": "1",
        "line": 100,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "zip_code",
        "line": 100,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "year",
        "line": 100,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 100,
        "column": 26
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 100,
        "column": 32
      },
      {
        "id": "/",
        "value": "/",
        "line": 100,
        "column": 42
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 100,
        "column": 43
      },
      {
        "id": "/",
        "value": "/",
        "line": 100,
        "column": 55
      },
      {
        "id": "identifier",
        "value": "Geographic",
        "line": 100,
        "column": 56
      },
      {
        "id": "/",
        "value": "/",
        "line": 100,
        "column": 66
      },
      {
        "id": "identifier",
        "value": "ZipCodeSupplyInfo_3m.dta",
        "line": 100,
        "column": 67
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "nogen",
        "line": 100,
        "column": 93
      },
      {
        "id": "identifier",
        "value": "keep",
        "line": 100,
        "column": 99
      },
      {
        "id": "identifier",
        "value": "match",
        "line": 100,
        "column": 104
      },
      {
        "id": "identifier",
        "value": "master",
        "line": 100,
        "column": 110
      },
      {
        "id": "identifier",
        "value": "keepusing",
        "line": 101,
        "column": 3
      },
      {
        "id": "`'",
        "value": "`ZipChars'",
        "line": 101,
        "column": 13
      },
      {
        "id": "identifier",
        "value": "est_LSmallGroc",
        "line": 101,
        "column": 24
      },
      {
        "id": "identifier",
        "value": "est_LSmallGroc_3m",
        "line": 101,
        "column": 39
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 102,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 102,
        "column": 10
      }
    ],
    "in": [
      {
        "id": "`'",
        "value": "`ZipChars'",
        "line": 102,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "est_LSmallGroc",
        "line": 102,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "est_LSmallGroc_3m",
        "line": 102,
        "column": 43
      },
      {
        "id": "{",
        "value": "{",
        "line": 102,
        "column": 61
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "rename",
      "line": 103,
      "column": 3
    },
    "varlist": [
      {
        "id": "`'",
        "value": "`var'",
        "line": 103,
        "column": 10
      },
      {
        "id": "`'",
        "value": "`var'",
        "line": 103,
        "column": 16
      },
      {
        "id": "identifier",
        "value": "Pre",
        "line": 103,
        "column": 21
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "drop",
      "line": 105,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "year",
        "line": 105,
        "column": 7
      }
    ]
  },
  {
    "id": "comment",
    "value": "/* Balanced indicator variables and expenditures at entrant retailer */",
    "line": 108,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 109,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "d",
        "line": 109,
        "column": 10
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "$dlist",
        "line": 109,
        "column": 15
      },
      {
        "id": "{",
        "value": "{",
        "line": 109,
        "column": 22
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 110,
      "column": 3
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "window",
        "line": 110,
        "column": 11
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "$WindowList",
        "line": 110,
        "column": 21
      },
      {
        "id": "{",
        "value": "{",
        "line": 110,
        "column": 33
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "sort",
      "line": 111,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "household_code",
        "line": 111,
        "column": 9
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 111,
        "column": 24
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "local",
      "line": 112,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "prewindow",
        "line": 112,
        "column": 10
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "real",
        "line": 112,
        "column": 22
      },
      {
        "id": "identifier",
        "value": "substr",
        "line": 112,
        "column": 27
      },
      {
        "id": "string",
        "value": "\"`window'\"",
        "line": 112,
        "column": 34
      },
      {
        "id": ",",
        "value": ",",
        "line": 112,
        "column": 44
      },
      {
        "id": "number",
        "value": "1",
        "line": 112,
        "column": 45
      },
      {
        "id": ",",
        "value": ",",
        "line": 112,
        "column": 46
      },
      {
        "id": "number",
        "value": "1",
        "line": 112,
        "column": 47
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "local",
      "line": 113,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "postwindow",
        "line": 113,
        "column": 10
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "real",
        "line": 113,
        "column": 23
      },
      {
        "id": "identifier",
        "value": "substr",
        "line": 113,
        "column": 28
      },
      {
        "id": "string",
        "value": "\"`window'\"",
        "line": 113,
        "column": 35
      },
      {
        "id": ",",
        "value": ",",
        "line": 113,
        "column": 45
      },
      {
        "id": "number",
        "value": "2",
        "line": 113,
        "column": 46
      },
      {
        "id": ",",
        "value": ",",
        "line": 113,
        "column": 47
      },
      {
        "id": "number",
        "value": "2",
        "line": 113,
        "column": 48
      }
    ]
  },
  {
    "id": "comment",
    "value": "*** Balanced for figure",
    "line": 114,
    "column": 4
  },
  {
    "id": "comment",
    "value": "* Define as Balanced if we see one entry, `prewindow' quarters before, and `postwindow' quarters after, with no missing quarters, in the same location",
    "line": 115,
    "column": 5
  },
  {
    "id": "comment",
    "value": "** Balanced`window'_`d'_begin will represent the entry quarter of a balanced window.",
    "line": 116,
    "column": 4
  },
  {
    "id": "comment",
    "value": "// & inlist(subchannel_`d',\"5-Supermarket-Conventional\")==1 // ,\"6-Supercenter\"",
    "line": 117,
    "column": 68
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 117,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "byte",
        "line": 117,
        "column": 8
      },
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 117,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 117,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 117,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 117,
        "column": 30
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 117,
        "column": 33
      }
    ],
    "=": [
      {
        "id": "number",
        "value": "1",
        "line": 117,
        "column": 42
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "Q10PostEntryt_",
        "line": 117,
        "column": 47
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 117,
        "column": 61
      },
      {
        "id": "==",
        "value": "==",
        "line": 117,
        "column": 64
      },
      {
        "id": "number",
        "value": "1",
        "line": 117,
        "column": 66
      }
    ]
  },
  {
    "id": "comment",
    "value": "* Make sure we observe `prewindow' consecutive quarters before",
    "line": 118,
    "column": 4
  },
  {
    "id": "comment",
    "value": "/*forvalues l= 1/`prewindow' {\n\t\t\t\tlocal Qtr=10-`l'\n\t\t\t\treplace Balanced`window'_`d'_begin = 0 if household_code[_n-`l']!=household_code | YQ[_n-`l']!=YQ-`l' | Q`Qtr'PostEntryt_`d'[_n-`l']!=1 | CTractGroup[_n-`l']==CTractGroup\n\t\t\t}\n\t\t\t*/",
    "line": 119,
    "column": 4
  },
  {
    "id": "comment",
    "value": "* Make sure we observe `postwindow' consecutive quarters after",
    "line": 120,
    "column": 4
  },
  {
    "command": {
      "id": "identifier",
      "value": "forvalues",
      "line": 121,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "l",
        "line": 121,
        "column": 14
      }
    ],
    "=": [
      {
        "id": "-",
        "value": "-",
        "line": 121,
        "column": 16
      },
      {
        "id": "`'",
        "value": "`prewindow'",
        "line": 121,
        "column": 17
      },
      {
        "id": "/",
        "value": "/",
        "line": 121,
        "column": 28
      },
      {
        "id": "`'",
        "value": "`postwindow'",
        "line": 121,
        "column": 29
      },
      {
        "id": "{",
        "value": "{",
        "line": 121,
        "column": 42
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "local",
      "line": 122,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Qtr",
        "line": 122,
        "column": 11
      }
    ],
    "=": [
      {
        "id": "number",
        "value": "10",
        "line": 122,
        "column": 15
      },
      {
        "id": "+",
        "value": "+",
        "line": 122,
        "column": 17
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 122,
        "column": 18
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 123,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 123,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 123,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 123,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 123,
        "column": 30
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 123,
        "column": 33
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": ".",
        "line": 123,
        "column": 42
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "household_code",
        "line": 123,
        "column": 47
      }
    ],
    "weight": [
      {
        "id": "identifier",
        "value": "_n",
        "line": 123,
        "column": 62
      },
      {
        "id": "+",
        "value": "+",
        "line": 123,
        "column": 64
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 123,
        "column": 65
      },
      {
        "id": "]",
        "value": "]",
        "line": 123,
        "column": 68
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 123,
        "column": 69
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 123,
        "column": 71
      },
      {
        "id": "|",
        "value": "|",
        "line": 123,
        "column": 86
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 123,
        "column": 88
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 123,
        "column": 91
      },
      {
        "id": "+",
        "value": "+",
        "line": 123,
        "column": 93
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 123,
        "column": 94
      },
      {
        "id": "]",
        "value": "]",
        "line": 123,
        "column": 97
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 123,
        "column": 98
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 123,
        "column": 100
      },
      {
        "id": "+",
        "value": "+",
        "line": 123,
        "column": 102
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 123,
        "column": 103
      },
      {
        "id": "|",
        "value": "|",
        "line": 123,
        "column": 107
      },
      {
        "id": "identifier",
        "value": "Q",
        "line": 123,
        "column": 109
      },
      {
        "id": "`'",
        "value": "`Qtr'",
        "line": 123,
        "column": 110
      },
      {
        "id": "identifier",
        "value": "PostEntryt_",
        "line": 123,
        "column": 115
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 123,
        "column": 126
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 123,
        "column": 130
      },
      {
        "id": "+",
        "value": "+",
        "line": 123,
        "column": 132
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 123,
        "column": 133
      },
      {
        "id": "]",
        "value": "]",
        "line": 123,
        "column": 136
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 123,
        "column": 137
      },
      {
        "id": "number",
        "value": "1",
        "line": 123,
        "column": 139
      },
      {
        "id": "|",
        "value": "|",
        "line": 123,
        "column": 141
      },
      {
        "id": "identifier",
        "value": "CTractGroup",
        "line": 123,
        "column": 143
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 123,
        "column": 155
      },
      {
        "id": "+",
        "value": "+",
        "line": 123,
        "column": 157
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 123,
        "column": 158
      },
      {
        "id": "]",
        "value": "]",
        "line": 123,
        "column": 161
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 123,
        "column": 162
      },
      {
        "id": "identifier",
        "value": "CTractGroup",
        "line": 123,
        "column": 164
      }
    ]
  },
  {
    "id": "comment",
    "value": "* Ensure only one entry over the period",
    "line": 125,
    "column": 4
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 126,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 126,
        "column": 12
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 126,
        "column": 20
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 126,
        "column": 28
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 126,
        "column": 29
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 126,
        "column": 32
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": ".",
        "line": 126,
        "column": 41
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "CountEntryt_",
        "line": 126,
        "column": 46
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 126,
        "column": 58
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 126,
        "column": 61
      },
      {
        "id": "identifier",
        "value": "CountEntryt_",
        "line": 126,
        "column": 63
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 126,
        "column": 75
      }
    ],
    "weight": [
      {
        "id": "identifier",
        "value": "_n",
        "line": 126,
        "column": 79
      },
      {
        "id": "-",
        "value": "-",
        "line": 126,
        "column": 81
      },
      {
        "id": "`'",
        "value": "`prewindow'",
        "line": 126,
        "column": 82
      },
      {
        "id": "]",
        "value": "]",
        "line": 126,
        "column": 93
      },
      {
        "id": "+",
        "value": "+",
        "line": 126,
        "column": 94
      },
      {
        "id": "number",
        "value": "1",
        "line": 126,
        "column": 95
      },
      {
        "id": "|",
        "value": "|",
        "line": 126,
        "column": 97
      },
      {
        "id": "identifier",
        "value": "CountEntryt_",
        "line": 126,
        "column": 99
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 126,
        "column": 111
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 126,
        "column": 114
      },
      {
        "id": "identifier",
        "value": "CountEntryt_",
        "line": 126,
        "column": 116
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 126,
        "column": 128
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 126,
        "column": 132
      },
      {
        "id": "+",
        "value": "+",
        "line": 126,
        "column": 134
      },
      {
        "id": "`'",
        "value": "`postwindow'",
        "line": 126,
        "column": 135
      },
      {
        "id": "]",
        "value": "]",
        "line": 126,
        "column": 147
      }
    ]
  },
  {
    "id": "comment",
    "value": "* If any balanced windows will conflict, drop the later one",
    "line": 128,
    "column": 4
  },
  {
    "id": "comment",
    "value": "* This does allow windows to persist if there is an unbalanced panel between them",
    "line": 129,
    "column": 5
  },
  {
    "command": {
      "id": "identifier",
      "value": "local",
      "line": 130,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "begin",
        "line": 130,
        "column": 10
      }
    ],
    "=": [
      {
        "id": "`'",
        "value": "`postwindow'",
        "line": 130,
        "column": 18
      },
      {
        "id": "+",
        "value": "+",
        "line": 130,
        "column": 30
      },
      {
        "id": "number",
        "value": "1",
        "line": 130,
        "column": 31
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "local",
      "line": 131,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "end",
        "line": 131,
        "column": 10
      }
    ],
    "=": [
      {
        "id": "`'",
        "value": "`postwindow'",
        "line": 131,
        "column": 16
      },
      {
        "id": "+",
        "value": "+",
        "line": 131,
        "column": 28
      },
      {
        "id": "`'",
        "value": "`prewindow'",
        "line": 131,
        "column": 29
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "forvalues",
      "line": 132,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "q",
        "line": 132,
        "column": 14
      }
    ],
    "=": [
      {
        "id": "`'",
        "value": "`begin'",
        "line": 132,
        "column": 18
      },
      {
        "id": "/",
        "value": "/",
        "line": 132,
        "column": 25
      },
      {
        "id": "`'",
        "value": "`end'",
        "line": 132,
        "column": 26
      },
      {
        "id": "{",
        "value": "{",
        "line": 132,
        "column": 32
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 133,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 133,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 133,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 133,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 133,
        "column": 30
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 133,
        "column": 33
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": ".",
        "line": 133,
        "column": 42
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 133,
        "column": 47
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 133,
        "column": 55
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 133,
        "column": 63
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 133,
        "column": 64
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 133,
        "column": 67
      }
    ],
    "weight": [
      {
        "id": "identifier",
        "value": "_n",
        "line": 133,
        "column": 74
      },
      {
        "id": "-",
        "value": "-",
        "line": 133,
        "column": 76
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 133,
        "column": 77
      },
      {
        "id": "]",
        "value": "]",
        "line": 133,
        "column": 80
      },
      {
        "id": "==",
        "value": "==",
        "line": 133,
        "column": 81
      },
      {
        "id": "number",
        "value": "1",
        "line": 133,
        "column": 83
      },
      {
        "id": "&",
        "value": "&",
        "line": 133,
        "column": 85
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 133,
        "column": 87
      },
      {
        "id": "==",
        "value": "==",
        "line": 133,
        "column": 101
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 133,
        "column": 103
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 133,
        "column": 118
      },
      {
        "id": "-",
        "value": "-",
        "line": 133,
        "column": 120
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 133,
        "column": 121
      },
      {
        "id": "]",
        "value": "]",
        "line": 133,
        "column": 124
      },
      {
        "id": "&",
        "value": "&",
        "line": 134,
        "column": 6
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 134,
        "column": 8
      },
      {
        "id": "==",
        "value": "==",
        "line": 134,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 134,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 134,
        "column": 15
      },
      {
        "id": "-",
        "value": "-",
        "line": 134,
        "column": 17
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 134,
        "column": 18
      },
      {
        "id": "]",
        "value": "]",
        "line": 134,
        "column": 21
      },
      {
        "id": "+",
        "value": "+",
        "line": 134,
        "column": 22
      },
      {
        "id": "`'",
        "value": "`q'",
        "line": 134,
        "column": 23
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Generate the balanced window indicator and the retailer code for that entry",
    "line": 137,
    "column": 4
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 138,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "byte",
        "line": 138,
        "column": 8
      },
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 138,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 138,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 138,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 138,
        "column": 30
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "cond",
        "line": 138,
        "column": 36
      },
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 138,
        "column": 41
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 138,
        "column": 49
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 138,
        "column": 57
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 138,
        "column": 58
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 138,
        "column": 61
      },
      {
        "id": "==",
        "value": "==",
        "line": 138,
        "column": 67
      },
      {
        "id": "number",
        "value": "1",
        "line": 138,
        "column": 69
      },
      {
        "id": ",",
        "value": ",",
        "line": 138,
        "column": 70
      },
      {
        "id": "number",
        "value": "1",
        "line": 138,
        "column": 71
      },
      {
        "id": ",",
        "value": ",",
        "line": 138,
        "column": 72
      },
      {
        "id": "number",
        "value": "0",
        "line": 138,
        "column": 73
      }
    ]
  },
  {
    "id": "comment",
    "value": "*gen long Entrantt_store_code`window'_`d' = .",
    "line": 139,
    "column": 4
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 140,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "long",
        "line": 140,
        "column": 8
      },
      {
        "id": "identifier",
        "value": "Entrantt_retailer_code",
        "line": 140,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 140,
        "column": 35
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 140,
        "column": 43
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 140,
        "column": 44
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": ".",
        "line": 140,
        "column": 50
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "forvalues",
      "line": 141,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "l",
        "line": 141,
        "column": 14
      }
    ],
    "=": [
      {
        "id": "-",
        "value": "-",
        "line": 141,
        "column": 16
      },
      {
        "id": "`'",
        "value": "`prewindow'",
        "line": 141,
        "column": 17
      },
      {
        "id": "/",
        "value": "/",
        "line": 141,
        "column": 28
      },
      {
        "id": "`'",
        "value": "`postwindow'",
        "line": 141,
        "column": 29
      },
      {
        "id": "{",
        "value": "{",
        "line": 141,
        "column": 42
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 142,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 142,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 142,
        "column": 21
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 142,
        "column": 29
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 142,
        "column": 30
      }
    ],
    "=": [
      {
        "id": "number",
        "value": "1",
        "line": 142,
        "column": 34
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 142,
        "column": 39
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 142,
        "column": 47
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 142,
        "column": 55
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 142,
        "column": 56
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 142,
        "column": 59
      }
    ],
    "weight": [
      {
        "id": "identifier",
        "value": "_n",
        "line": 142,
        "column": 66
      },
      {
        "id": "-",
        "value": "-",
        "line": 142,
        "column": 68
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 142,
        "column": 69
      },
      {
        "id": "]",
        "value": "]",
        "line": 142,
        "column": 72
      },
      {
        "id": "==",
        "value": "==",
        "line": 142,
        "column": 73
      },
      {
        "id": "number",
        "value": "1",
        "line": 142,
        "column": 75
      }
    ]
  },
  {
    "id": "comment",
    "value": "*replace Entrantt_store_code`window'_`d' = Entrantt_store_code_`d'[_n-`l'] if Balanced`window'_`d'_begin[_n-`l']==1",
    "line": 143,
    "column": 5
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 144,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "Entrantt_retailer_code",
        "line": 144,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 144,
        "column": 35
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 144,
        "column": 43
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 144,
        "column": 44
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "Entrantt_retailer_code_",
        "line": 144,
        "column": 50
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 144,
        "column": 73
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "Balanced",
        "line": 144,
        "column": 88
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 144,
        "column": 96
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 144,
        "column": 104
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 144,
        "column": 105
      },
      {
        "id": "identifier",
        "value": "_begin",
        "line": 144,
        "column": 108
      }
    ],
    "weight": [
      {
        "id": "identifier",
        "value": "_n",
        "line": 144,
        "column": 77
      },
      {
        "id": "-",
        "value": "-",
        "line": 144,
        "column": 79
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 144,
        "column": 80
      },
      {
        "id": "]",
        "value": "]",
        "line": 144,
        "column": 83
      },
      {
        "id": "identifier",
        "value": "_n",
        "line": 144,
        "column": 115
      },
      {
        "id": "-",
        "value": "-",
        "line": 144,
        "column": 117
      },
      {
        "id": "`'",
        "value": "`l'",
        "line": 144,
        "column": 118
      },
      {
        "id": "]",
        "value": "]",
        "line": 144,
        "column": 121
      },
      {
        "id": "==",
        "value": "==",
        "line": 144,
        "column": 122
      },
      {
        "id": "number",
        "value": "1",
        "line": 144,
        "column": 124
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Merge expenditures at entrant retailer",
    "line": 147,
    "column": 4
  },
  {
    "id": "comment",
    "value": "// store",
    "line": 148,
    "column": 31
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 148,
      "column": 4
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "code",
        "line": 148,
        "column": 12
      }
    ],
    "in": [
      {
        "id": "identifier",
        "value": "retailer",
        "line": 148,
        "column": 20
      },
      {
        "id": "{",
        "value": "{",
        "line": 148,
        "column": 29
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 149,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "long",
        "line": 149,
        "column": 9
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 149,
        "column": 14
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 149,
        "column": 20
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "Entrantt_",
        "line": 149,
        "column": 31
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 149,
        "column": 40
      },
      {
        "id": "identifier",
        "value": "_code",
        "line": 149,
        "column": 46
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 149,
        "column": 51
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 149,
        "column": 59
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 149,
        "column": 60
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "merge",
      "line": 150,
      "column": 5
    },
    "varlist": [
      {
        "id": "number",
        "value": "1",
        "line": 150,
        "column": 11
      },
      {
        "id": ":",
        "value": ":",
        "line": 150,
        "column": 12
      },
      {
        "id": "number",
        "value": "1",
        "line": 150,
        "column": 13
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 150,
        "column": 15
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 150,
        "column": 30
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 150,
        "column": 33
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 150,
        "column": 39
      },
      {
        "id": "identifier",
        "value": "using",
        "line": 150,
        "column": 48
      },
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 150,
        "column": 54
      },
      {
        "id": "/",
        "value": "/",
        "line": 150,
        "column": 64
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 150,
        "column": 65
      },
      {
        "id": "/",
        "value": "/",
        "line": 150,
        "column": 77
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 150,
        "column": 78
      },
      {
        "id": "/",
        "value": "/",
        "line": 150,
        "column": 86
      },
      {
        "id": "identifier",
        "value": "HHxQuarterx",
        "line": 150,
        "column": 87
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 150,
        "column": 98
      },
      {
        "id": "identifier",
        "value": ".dta",
        "line": 150,
        "column": 104
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "keep",
        "line": 151,
        "column": 6
      },
      {
        "id": "identifier",
        "value": "match",
        "line": 151,
        "column": 11
      },
      {
        "id": "identifier",
        "value": "master",
        "line": 151,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "keepusing",
        "line": 151,
        "column": 25
      },
      {
        "id": "identifier",
        "value": "expshare",
        "line": 151,
        "column": 35
      },
      {
        "id": "identifier",
        "value": "nogen",
        "line": 151,
        "column": 45
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "rename",
      "line": 153,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare",
        "line": 153,
        "column": 12
      },
      {
        "id": "identifier",
        "value": "expshare_E",
        "line": 153,
        "column": 21
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 153,
        "column": 31
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 153,
        "column": 37
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 153,
        "column": 45
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 153,
        "column": 46
      }
    ]
  },
  {
    "id": "comment",
    "value": "// This sets to zero if the retailer code is known. If retailer code not known, then this is missing.",
    "line": 154,
    "column": 101
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 154,
      "column": 5
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "expshare_E",
        "line": 154,
        "column": 13
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 154,
        "column": 23
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 154,
        "column": 29
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 154,
        "column": 37
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 154,
        "column": 38
      }
    ],
    "=": [
      {
        "id": "number",
        "value": "0",
        "line": 154,
        "column": 44
      }
    ],
    "if": [
      {
        "id": "identifier",
        "value": "expshare_E",
        "line": 154,
        "column": 49
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 154,
        "column": 59
      },
      {
        "id": "`'",
        "value": "`window'",
        "line": 154,
        "column": 65
      },
      {
        "id": "identifier",
        "value": "_",
        "line": 154,
        "column": 73
      },
      {
        "id": "`'",
        "value": "`d'",
        "line": 154,
        "column": 74
      },
      {
        "id": "==",
        "value": "==",
        "line": 154,
        "column": 77
      },
      {
        "id": "identifier",
        "value": ".",
        "line": 154,
        "column": 79
      },
      {
        "id": "&",
        "value": "&",
        "line": 154,
        "column": 81
      },
      {
        "id": "`'",
        "value": "`code'",
        "line": 154,
        "column": 83
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 154,
        "column": 89
      },
      {
        "id": "!=",
        "value": "!=",
        "line": 154,
        "column": 97
      },
      {
        "id": "identifier",
        "value": ".",
        "line": 154,
        "column": 99
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "drop",
      "line": 155,
      "column": 5
    },
    "varlist": [
      {
        "id": "`'",
        "value": "`code'",
        "line": 155,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "_code_uc",
        "line": 155,
        "column": 16
      }
    ]
  },
  {
    "id": "comment",
    "value": "/* include this in EntryRegs.do\n\t\t\t*** Make the PostEntryt indicators 0 if in the Balanced window but not part of the entry being studied. \n\t\t\t\t* This is necessary only for cases where the pre-window is part of the end of the post-window for a previous entry that occurred more than 3 quarters before, or when the post-window is part of the pre-window for a later entry that occurs more than 8 quarters later.\n\t\t\tlocal begin = 10-`prewindow'\n\t\t\tlocal end = 10+`postwindow'\n\t\t\tforvalues q = `begin'/`end' {\n\t\t\t\treplace Q`q'PostEntryt_`d' = 0 if Balanced`window'_`d'==1 & Balanced`window'_`d'_begin[_n+10-`q']!=1\n\t\t\t}\n\t\t\t*/",
    "line": 157,
    "column": 4
  },
  {
    "id": "comment",
    "value": "*drop Balanced`window'_`d'_begin",
    "line": 158,
    "column": 4
  },
  {
    "id": "comment",
    "value": "** Rescale variables",
    "line": 163,
    "column": 2
  },
  {
    "id": "comment",
    "value": "* Produce share and expenditure shares in percentage points",
    "line": 164,
    "column": 2
  },
  {
    "id": "comment",
    "value": "// FreshProduce",
    "line": 165,
    "column": 46
  },
  {
    "command": {
      "id": "identifier",
      "value": "foreach",
      "line": 165,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 165,
        "column": 10
      },
      {
        "id": "identifier",
        "value": "of",
        "line": 165,
        "column": 14
      },
      {
        "id": "identifier",
        "value": "varlist",
        "line": 165,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "Produce",
        "line": 165,
        "column": 25
      },
      {
        "id": "identifier",
        "value": "expshare_",
        "line": 165,
        "column": 33
      },
      {
        "id": "*",
        "value": "*",
        "line": 165,
        "column": 42
      },
      {
        "id": "{",
        "value": "{",
        "line": 165,
        "column": 44
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "replace",
      "line": 166,
      "column": 3
    },
    "varlist": [
      {
        "id": "`'",
        "value": "`var'",
        "line": 166,
        "column": 11
      }
    ],
    "=": [
      {
        "id": "`'",
        "value": "`var'",
        "line": 166,
        "column": 19
      },
      {
        "id": "*",
        "value": "*",
        "line": 166,
        "column": 24
      },
      {
        "id": "number",
        "value": "100",
        "line": 166,
        "column": 25
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "gen",
      "line": 168,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "lnCalories",
        "line": 168,
        "column": 6
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "ln",
        "line": 168,
        "column": 19
      },
      {
        "id": "identifier",
        "value": "Calories",
        "line": 168,
        "column": 22
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Household x census tract fixed effect group",
    "line": 170,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "egen",
      "line": 171,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "household_location",
        "line": 171,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "group",
        "line": 171,
        "column": 28
      },
      {
        "id": "identifier",
        "value": "household_code",
        "line": 171,
        "column": 34
      },
      {
        "id": "identifier",
        "value": "CTractGroup",
        "line": 171,
        "column": 49
      }
    ]
  },
  {
    "id": "comment",
    "value": "** Time/Region controls",
    "line": 173,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "egen",
      "line": 174,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "RegionYear",
        "line": 174,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "group",
        "line": 174,
        "column": 20
      },
      {
        "id": "identifier",
        "value": "region_code",
        "line": 174,
        "column": 26
      },
      {
        "id": "identifier",
        "value": "panel_year",
        "line": 174,
        "column": 38
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "egen",
      "line": 175,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "RegionYQ",
        "line": 175,
        "column": 7
      }
    ],
    "=": [
      {
        "id": "identifier",
        "value": "group",
        "line": 175,
        "column": 18
      },
      {
        "id": "identifier",
        "value": "region_code",
        "line": 175,
        "column": 24
      },
      {
        "id": "identifier",
        "value": "YQ",
        "line": 175,
        "column": 36
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "compress",
      "line": 176,
      "column": 2
    }
  },
  {
    "id": "comment",
    "value": "** Labels ",
    "line": 178,
    "column": 2
  },
  {
    "command": {
      "id": "identifier",
      "value": "label",
      "line": 179,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 179,
        "column": 8
      },
      {
        "id": "identifier",
        "value": "CountEntryt_10",
        "line": 179,
        "column": 12
      },
      {
        "id": "string",
        "value": "\"Post entry: 0-10 minutes\"",
        "line": 179,
        "column": 27
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "label",
      "line": 180,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 180,
        "column": 8
      },
      {
        "id": "identifier",
        "value": "CountEntryt_15",
        "line": 180,
        "column": 12
      },
      {
        "id": "string",
        "value": "\"Post entry: 10-15 minutes\"",
        "line": 180,
        "column": 27
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "label",
      "line": 181,
      "column": 10
    },
    "pre": [
      {
        "command": {
          "id": "identifier",
          "value": "capture",
          "line": 181,
          "column": 2
        }
      }
    ],
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 181,
        "column": 16
      },
      {
        "id": "identifier",
        "value": "CountEntryt_S_10",
        "line": 181,
        "column": 20
      },
      {
        "id": "string",
        "value": "\"Post entry: 0-10 minutes\"",
        "line": 181,
        "column": 37
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "label",
      "line": 182,
      "column": 10
    },
    "pre": [
      {
        "command": {
          "id": "identifier",
          "value": "capture",
          "line": 182,
          "column": 2
        }
      }
    ],
    "varlist": [
      {
        "id": "identifier",
        "value": "var",
        "line": 182,
        "column": 16
      },
      {
        "id": "identifier",
        "value": "CountEntryt_S_15",
        "line": 182,
        "column": 20
      },
      {
        "id": "string",
        "value": "\"Post entry: 10-15 minutes\"",
        "line": 182,
        "column": 37
      }
    ]
  },
  {
    "command": {
      "id": "identifier",
      "value": "save",
      "line": 183,
      "column": 2
    },
    "varlist": [
      {
        "id": "identifier",
        "value": "$Externals",
        "line": 183,
        "column": 7
      },
      {
        "id": "/",
        "value": "/",
        "line": 183,
        "column": 17
      },
      {
        "id": "identifier",
        "value": "Calculations",
        "line": 183,
        "column": 18
      },
      {
        "id": "/",
        "value": "/",
        "line": 183,
        "column": 30
      },
      {
        "id": "identifier",
        "value": "Homescan",
        "line": 183,
        "column": 31
      },
      {
        "id": "/",
        "value": "/",
        "line": 183,
        "column": 39
      },
      {
        "id": "`'",
        "value": "`dataset'",
        "line": 183,
        "column": 40
      },
      {
        "id": "identifier",
        "value": "withEntry.dta",
        "line": 183,
        "column": 49
      }
    ],
    "options": [
      {
        "id": "identifier",
        "value": "replace",
        "line": 183,
        "column": 64
      }
    ]
  }
]