******************************************************************************************This do-file generates all models used in the main text. ******************************************************************************************For each sub-sample of countries (e.g., small producers only; mineral-countries only; etc..) *we generate the sample-specific average of Polity(t-4) in autocracy and democracy. This is*then used to calculate deviations from the average for each country-year observation.*In this way, the coefficients of PRa and PRd in the heterogeneous model can be interpreted*as the effect of a price shock for the country at the average level of autocracy or democracy*for each specific sample of countries.*************************************use $Output_aux/aux1, clear**************************************Interactions common to all models*democracy dummygen dem4=1 if pl4>0 & pl4!=.replace dem4=0 if dem4==. & pl4!=.*autocracy dummygen aut4=1 if pl4<=0 & pl4!=.replace aut4=0 if aut4==. & pl4!=.*Price in autocracy and democracygen pra=pr*aut4gen prd=pr*dem4                                    ***********************************************************Tables 3,4: Baseline + polity components**********************************************************                                                                                                      *AVG POLITY LEVEL AUTOCRATIC COUNTRIESegen avg_pl4_aut1=mean(pl4) if pl4<=0 *DEVIATIONS FROM AVERAGE POLITY LEVEL IN AUTOCRACYgen pl4a1=pl4-avg_pl4_aut1 if pl4<=0 replace pl4a1=0 if pl4a1==. & pl4!=. *INTERACTION POLITY*PRICE WITH POLITY IN DEVIATIONS FROM THE AVERAGE AUT POLITYgen pl4a1pr=pr*aut4*pl4a1       replace pl4a1pr=0 if pl4a1pr==. & pl4!=.*AVG POLITY LEVEL DEMOCRATIC COUNTRIESegen avg_pl4_dem1=mean(pl4) if pl4>0 *DEVIATIONS FROM AVERAGE POLITY LEVEL IN DEMOCRACYgen pl4d1=pl4-avg_pl4_dem1 if pl4>0 replace pl4d1=0 if pl4d1==. & pl4!=.*INTERACTION POLITY*PRICE WITH POLITY IN DEVIATIONS FROM THE AVERAGE DEM POLITYgen pl4d1pr=pr*dem4*pl4d1       replace pl4d1pr=0 if pl4d1pr==. & pl4!=.             *********************************** *Table 5: EXCLUDING SHARES ***********************************                                                                    *Ex. 1st decile avshareegen avg_pl4_aut2=mean(pl4) if pl4<=0 & dec_avshare!=1gen pl4a2=pl4-avg_pl4_aut2 if pl4<=0  replace pl4a2=0 if pl4a2==. & pl4!=.  gen pl4a2pr=pr*aut4*pl4a2       replace pl4a2pr=0 if pl4a2pr==.  & pl4!=.egen avg_pl4_dem2=mean(pl4) if pl4>0 & dec_avshare!=1gen pl4d2=pl4-avg_pl4_dem2 if pl4>0 replace pl4d2=0 if pl4d2==. & pl4!=.gen pl4d2pr=pr*dem4*pl4d2       replace pl4d2pr=0 if pl4d2pr==. & pl4!=.			 			 *Ex. 1st quartile avshare	xtile quart_avshare=avshare, nq(4)egen avg_pl4_aut3=mean(pl4) if pl4<=0 & quart_avshare>1gen pl4a3=pl4-avg_pl4_aut3 if pl4<=0 replace pl4a3=0 if pl4a3==. & pl4!=. gen pl4a3pr=pr*aut4*pl4a3       replace pl4a3pr=0 if pl4a3pr==.  & pl4!=.egen avg_pl4_dem3=mean(pl4) if pl4>0 & quart_avshare>1gen pl4d3=pl4-avg_pl4_dem3 if pl4>0 replace pl4d3=0 if pl4d3==. & pl4!=.gen pl4d3pr=pr*dem4*pl4d3     replace pl4d3pr=0 if pl4d3pr==. & pl4!=.*Ex. below medianxtile median_avshare=avshare, nq(2)egen avg_pl4_aut4=mean(pl4) if pl4<=0 & median_avshare>1gen pl4a4=pl4-avg_pl4_aut4 if pl4<=0 replace pl4a4=0 if pl4a4==. & pl4!=. gen pl4a4pr=pr*aut4*pl4a4       replace pl4a4pr=0 if pl4a4pr==.  & pl4!=.egen avg_pl4_dem4=mean(pl4) if pl4>0 & median_avshare>1gen pl4d4=pl4-avg_pl4_dem4 if pl4>0 replace pl4d4=0 if pl4d4==. & pl4!=.gen pl4d4pr=pr*dem4*pl4d4     replace pl4d4pr=0 if pl4d4pr==. & pl4!=.									********************************************************** *TABLE 6***********************************************************Positive changes onlygen dpol2p=d_pol2_rob if d_pol2_rob>0 & d_pol2_rob!=.replace dpol2p=0 if dpol2p==. & d_pol2_rob==0*Dummy for positive changesgen dum_dpol2=1 if d_pol2_rob>0 & d_pol2_rob!=.replace dum_dpol2=0 if dum_dpol2==. & d_pol2_rob<=0 *Negative Changes onlygen dpol2n=d_pol2_rob if d_pol2_rob<0 & d_pol2_rob!=.replace dpol2n=0 if dpol2n==. & d_pol2_rob==0*Dummy for negative changesgen dum_dpol2_bis=1 if d_pol2_rob<0 & d_pol2_rob!=.replace dum_dpol2_bis=0 if dum_dpol2_bis==. & d_pol2_rob<=0 *Unbounded countriessort code yearby code:egen mmin=min(pl4)by code:egen max=max(pl4)egen avg_pl4_aut5=mean(pl4) if pl4<=0  & mmin>-10gen pl4a5=pl4-avg_pl4_aut5 if pl4<=0    & mmin>-10replace pl4a5=0 if pl4a5==. & pl4!=.   & mmin>-10gen pl4a5pr=pr*aut4*pl4a5       replace pl4a5pr=0 if pl4a5pr==.  & pl4!=.  & mmin>-10egen avg_pl4_dem5=mean(pl4) if pl4>0  & max<10gen pl4d5=pl4-avg_pl4_dem5 if pl4>0   & max<10replace pl4d5=0 if pl4d5==. & pl4!=. & max<10gen pl4d5pr=pr*dem4*pl4d5       replace pl4d5pr=0 if pl4d5pr==. & pl4!=. & max<10*Unbounded observationsegen avg_pl4_aut6=mean(pl4) if pl4<=0  & pl4>-10gen pl4a6=pl4-avg_pl4_aut6 if pl4<=0  & pl4>-10 replace pl4a6=0 if pl4a6==. & pl4!=.  & pl4>-10gen pl4a6pr=pr*aut4*pl4a6      replace pl4a6pr=0 if pl4a6pr==.  & pl4!=.egen avg_pl4_dem6=mean(pl4) if pl4>0 & pl4<10gen pl4d6=pl4-avg_pl4_dem6 if pl4>0  & pl4<10replace pl4d6=0 if pl4d6==. & pl4!=. & pl4<10gen pl4d6pr=pr*dem4*pl4d6       replace pl4d6pr=0 if pl4d6pr==. & pl4!=.			 			 ********************************************************** *TABLE 7 (opec+big producers)**********************************************************egen avg_pl4_aut7=mean(pl4) if pl4<=0 & opec!=1gen pl4a7=pl4-avg_pl4_aut7 if pl4<=0 replace pl4a7=0 if pl4a7==. & pl4!=. gen pl4a7pr=pr*aut4*pl4a7       replace pl4a7pr=0 if pl4a7pr==.  & pl4!=.egen avg_pl4_dem7=mean(pl4) if pl4>0 & opec!=1gen pl4d7=pl4-avg_pl4_dem7 if pl4>0 replace pl4d7=0 if pl4d7==. & pl4!=.gen pl4d7pr=pr*dem4*pl4d7      replace pl4d7pr=0 if pl4d7pr==. & pl4!=.egen avg_pl4_aut8=mean(pl4) if pl4<=0 & prod!=1gen pl4a8=pl4-avg_pl4_aut8 if pl4<=0 replace pl4a8=0 if pl4a8==. & pl4!=. gen pl4a8pr=pr*aut4*pl4a8       replace pl4a8pr=0 if pl4a8pr==.  & pl4!=.egen avg_pl4_dem8=mean(pl4) if pl4>0 & prod!=1gen pl4d8=pl4-avg_pl4_dem8 if pl4>0 replace pl4d8=0 if pl4d8==. & pl4!=.gen pl4d8pr=pr*dem4*pl4d8     replace pl4d8pr=0 if pl4d8pr==. & pl4!=.********************************************************** *TABLE 8: General price indices********************************************************** sort code yearmerge 1:1 code year using $Output_aux/gpi       //built in gpi.dodrop if _m==2drop _msort code yearby code:gen gpi_l=gpi[_n-1] if year==year[_n-1]+1by code:gen gpi_g=(gpi/gpi_l)-1by code:gen gpi_g_l=gpi_g[_n-1] if year==year[_n-1]+1by code:gen gpi_g_l2=gpi_g[_n-2] if year==year[_n-1]+1by code:gen gpi_g_l3=gpi_g[_n-3] if year==year[_n-1]+1by code:gen gpi_pr=(gpi_g_l+gpi_g_l2+gpi_g_l3)/3gen gpi_pra=gpi_pr*aut4gen gpi_prd=gpi_pr*dem4gen pl4a1gpipr=pl4a1*gpi_prgen pl4d1gpipr=pl4d1*gpi_prlocal group 75 80 90 00 01foreach c of local group{sort code yearby code:gen gpi_`c'_l=gpi_`c'[_n-1] if year==year[_n-1]+1by code:gen gpi_`c'_g=(gpi_`c'/gpi_`c'_l)-1by code:gen gpi_`c'_pr=(gpi_`c'_g[_n-1]+gpi_`c'_g[_n-2]+gpi_`c'_g[_n-3])/3 gen gpi_`c'_pra=gpi_`c'_pr*aut4gen gpi_`c'_prd=gpi_`c'_pr*dem4}local fixed 1975 1980 1990 2000 2001                                                                                                                                                                                                                                                               foreach c of local fixed{egen avg_pl4_aut`c'=mean(pl4) if pl4<=0 & share_`c'!=0gen pl4a`c'=pl4-avg_pl4_aut`c' if pl4<=0 replace pl4a`c'=0 if pl4a`c'==. & pl4!=. egen avg_pl4_dem`c'=mean(pl4) if pl4>0 & share_`c'!=0gen pl4d`c'=pl4-avg_pl4_dem`c' if pl4>0 replace pl4d`c'=0 if pl4d`c'==. & pl4!=.}local group 75 80 90foreach c of local group{gen pl4a19`c'gpi`c'pr=pl4a19`c'*gpi_`c'_prgen pl4d19`c'gpi`c'pr=pl4d19`c'*gpi_`c'_pr }local group 00 01foreach c of local group{gen pl4a20`c'gpi`c'pr=pl4a20`c'*gpi_`c'_prgen pl4d20`c'gpi`c'pr=pl4d20`c'*gpi_`c'_pr }********************************************************** *TABLE 9: Point source/diffuse ; min/ non-min; oil/non-oil********************************************************** *Point-sourcegen ps=1 if princ_comm==58local group 63 65 71 73 76 142 143 145 148 132 133 237 300 23 25 27 28foreach c of local group{replace ps=1 if princ_comm==`c'}                                                    egen avg_pl4_aut9=mean(pl4) if pl4<=0 & ps==1gen pl4a9=pl4-avg_pl4_aut9 if pl4<=0  & ps==1replace pl4a9=0 if pl4a9==. & pl4!=.  & ps==1gen pl4a9pr=pr*aut4*pl4a9       replace pl4a9pr=0 if pl4a9pr==. & pl4!=.  & ps==1egen avg_pl4_dem9=mean(pl4) if pl4>0  & ps==1gen pl4d9=pl4-avg_pl4_dem9 if pl4>0  & ps==1replace pl4d9=0 if pl4d9==. & pl4!=.  & ps==1gen pl4d9pr=pr*dem4*pl4d9       replace pl4d9pr=0 if pl4d9pr==. & pl4!=.  & ps==1*Non point-source (diffuse)gen nps=1 if princ_comm==2local group 9 13 14 16 30 37 39 42 48 51 52 56 241 242 301 302foreach c of local group{replace nps=1 if princ_comm==`c'}egen avg_pl4_aut10=mean(pl4) if pl4<=0 & nps==1gen pl4a10=pl4-avg_pl4_aut10 if pl4<=0  & nps==1replace pl4a10=0 if pl4a10==. & pl4!=.  & nps==1gen pl4a10pr=pr*aut4*pl4a10       replace pl4a10pr=0 if pl4a10pr==. & pl4!=.  & nps==1egen avg_pl4_dem10=mean(pl4) if pl4>0  & nps==1gen pl4d10=pl4-avg_pl4_dem10 if pl4>0  & nps==1replace pl4d10=0 if pl4d10==. & pl4!=.  & nps==1gen pl4d10pr=pr*dem4*pl4d10       replace pl4d10pr=0 if pl4d10pr==. & pl4!=.  & nps==1*mineralgen min=1 if princ_comm==58local group 63 65 71 73 76 142 143 145 148 132 133 237 300foreach c of local group{replace min=1 if princ_comm==`c'}                                             egen avg_pl4_aut11=mean(pl4) if pl4<=0 & min==1gen pl4a11=pl4-avg_pl4_aut11 if pl4<=0  & min==1replace pl4a11=0 if pl4a11==. & pl4!=.  & min==1gen pl4a11pr=pr*aut4*pl4a11       replace pl4a11pr=0 if pl4a11pr==. & pl4!=.  & min==1egen avg_pl4_dem11=mean(pl4) if pl4>0  & min==1gen pl4d11=pl4-avg_pl4_dem11 if pl4>0  & min==1replace pl4d11=0 if pl4d11==. & pl4!=.  & min==1gen pl4d11pr=pr*dem4*pl4d11       replace pl4d11pr=0 if pl4d11pr==. & pl4!=.  & min==1*non-mineralgen nmin=1 if princ_comm==2local group 9 13 14 16 23 25 27 28 30 37 39 42 48 51 52 56 241 242 301 302foreach c of local group{replace nmin=1 if princ_comm==`c'}egen avg_pl4_aut12=mean(pl4) if pl4<=0 & nmin==1gen pl4a12=pl4-avg_pl4_aut12 if pl4<=0  & nmin==1replace pl4a12=0 if pl4a12==. & pl4!=.  & nmin==1gen pl4a12pr=pr*aut4*pl4a12       replace pl4a12pr=0 if pl4a12pr==. & pl4!=.  & nmin==1egen avg_pl4_dem12=mean(pl4) if pl4>0  & nmin==1gen pl4d12=pl4-avg_pl4_dem12 if pl4>0  & nmin==1replace pl4d12=0 if pl4d12==. & pl4!=.  & nmin==1gen pl4d12pr=pr*dem4*pl4d12       replace pl4d12pr=0 if pl4d12pr==. & pl4!=.  & nmin==1*oilgen oil=1 if princ_comm==73replace oil=0 if princ_comm!=73egen avg_pl4_aut13=mean(pl4) if pl4<=0 & oil==1gen pl4a13=pl4-avg_pl4_aut13 if pl4<=0  & oil==1replace pl4a13=0 if pl4a13==. & pl4!=.  & oil==1gen pl4a13pr=pr*aut4*pl4a13       replace pl4a13pr=0 if pl4a13pr==. & pl4!=.  & oil==1egen avg_pl4_dem13=mean(pl4) if pl4>0  & oil==1gen pl4d13=pl4-avg_pl4_dem13 if pl4>0  & oil==1replace pl4d13=0 if pl4d13==. & pl4!=.  & oil==1gen pl4d13pr=pr*dem4*pl4d13       replace pl4d13pr=0 if pl4d13pr==. & pl4!=.  & oil==1*non-oilegen avg_pl4_aut14=mean(pl4) if pl4<=0 & oil==0gen pl4a14=pl4-avg_pl4_aut14 if pl4<=0  & oil==0replace pl4a14=0 if pl4a14==. & pl4!=.  & oil==0gen pl4a14pr=pr*aut4*pl4a14       replace pl4a14pr=0 if pl4a14pr==. & pl4!=.  & oil==0egen avg_pl4_dem14=mean(pl4) if pl4>0  & oil==0gen pl4d14=pl4-avg_pl4_dem14 if pl4>0  & oil==0replace pl4d14=0 if pl4d14==. & pl4!=.  & oil==0gen pl4d14pr=pr*dem4*pl4d14       replace pl4d14pr=0 if pl4d14pr==. & pl4!=.  & oil==0*****************************************save $Output_aux/aux2,replace*****************************************