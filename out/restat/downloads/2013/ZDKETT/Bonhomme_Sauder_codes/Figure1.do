*******  This program computes Quantile Treatment Effects ***************  Figure 1 in the paper *************** The program uses Stata 10, with the Mata extension ********clearset mem 300mset more offcd \Users\uli\Desktop\Data_construction_comp\_submission_restat** Prepare outputset obs 99gen tau=.local j=1while `j'<=2{local k=1while `k'<=3{gen est`j'`k'=.gen low`j'`k'=.gen up`j'`k'=.local k=`k'+1}local j=`j'+1}save figure1, replace** Start loop on the covariatesscalar ncov=1while ncov<=2{** Start loop on the instruments Zscalar ninst=1while ninst<=3{do Figure1utilscalar ninst=ninst+1}scalar ncov=ncov+1}use figure1, clearscalar ncov=1while ncov<=2{local ncov=ncovscalar ninst=1while ninst<=3{local ninst=ninst#delimit ;twoway  (line est`ncov'`ninst' tau, lcolor(black) lpattern(solid) lwidth(medium)) (line low`ncov'`ninst' tau, lcolor(black) lpattern(dash) lwidth(thin)) (line up`ncov'`ninst' tau, lcolor(black) lpattern(dash) lwidth(thin))if abs(tau-.5)<=.49, ysc(r(-5 5)) yline(0) ytitle(quantile treatment effect)  xtitle(percentile) legend(order(1 "point estimate" 2 "+/- 2 standard errors") size(medsmall)) scheme(s1mono);graph export "\Users\uli\Desktop\Data_construction_comp\figure1`ncov'`ninst'.eps",  preview(on) replace; #delimit crsleep 1000scalar ninst=ninst+1}scalar ncov=ncov+1}