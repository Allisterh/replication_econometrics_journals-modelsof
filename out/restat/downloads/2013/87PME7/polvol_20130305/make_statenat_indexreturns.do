#delimit;
clear;
capture clear matrix;
set memory 3g;


use "$startdir/$outputdata/usa_1percent_all.dta";

sort bpl;
merge bpl using "$startdir/$outputdata/fipscodes.dta";
destring fips, replace;
recast int fips;
recast int statefip;
label values fips statefiplbl;
label values statefip statefiplbl;
gen samestate=0;
replace samestate=1 if statefip==fips;



keep year serial hhwt ftot hhincome age relate ind* fips bpl samestate;


gen ShoreInd=.;
replace ShoreInd=       1       if ind1990==    10      & ind1990!=.;
replace ShoreInd=       2       if ind1990==    11      & ind1990!=.;
replace ShoreInd=       2       if ind1990==    12      & ind1990!=.;
replace ShoreInd=       3       if ind1990==    30      & ind1990!=.;
replace ShoreInd=       3       if ind1990==    20      & ind1990!=.;
replace ShoreInd=       4       if ind1990==    31      & ind1990!=.;
replace ShoreInd=       5       if ind1990==    32      & ind1990!=.;
replace ShoreInd=       11      if ind1990==    40      & ind1990!=.;
replace ShoreInd=       12      if ind1990==    41      & ind1990!=.;
replace ShoreInd=       13      if ind1990==    42      & ind1990!=.;
replace ShoreInd=       14      if ind1990==    50      & ind1990!=.;
replace ShoreInd=       21      if ind1990==    60      & ind1990!=.;
replace ShoreInd=       21      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       21      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       21      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       21      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       31      if ind1990==    230     & ind1990!=.;
replace ShoreInd=       31      if ind1990==    231     & ind1990!=.;
replace ShoreInd=       31      if ind1990==    232     & ind1990!=.;
replace ShoreInd=       31      if ind1990==    241     & ind1990!=.;
replace ShoreInd=       32      if ind1990==    250     & ind1990!=.;
replace ShoreInd=       32      if ind1990==    251     & ind1990!=.;
replace ShoreInd=       32      if ind1990==    252     & ind1990!=.;
replace ShoreInd=       32      if ind1990==    261     & ind1990!=.;
replace ShoreInd=       32      if ind1990==    262     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    270     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    271     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    272     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    280     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    281     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    282     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    290     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    291     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    292     & ind1990!=.;
replace ShoreInd=       33      if ind1990==    300     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    301     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    310     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    311     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    312     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    320     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    321     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    322     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    331     & ind1990!=.;
replace ShoreInd=       34      if ind1990==    332     & ind1990!=.;
replace ShoreInd=       35      if ind1990==    340     & ind1990!=.;
replace ShoreInd=       35      if ind1990==    341     & ind1990!=.;
replace ShoreInd=       35      if ind1990==    342     & ind1990!=.;
replace ShoreInd=       35      if ind1990==    350     & ind1990!=.;
replace ShoreInd=       36      if ind1990==    351     & ind1990!=.;
replace ShoreInd=       36      if ind1990==    352     & ind1990!=.;
replace ShoreInd=       36      if ind1990==    360     & ind1990!=.;
replace ShoreInd=       36      if ind1990==    361     & ind1990!=.;
replace ShoreInd=       36      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       36      if ind1990==    370     & ind1990!=.;
replace ShoreInd=       37      if ind1990==    371     & ind1990!=.;
replace ShoreInd=       37      if ind1990==    372     & ind1990!=.;
replace ShoreInd=       37      if ind1990==    380     & ind1990!=.;
replace ShoreInd=       37      if ind1990==    381     & ind1990!=.;
replace ShoreInd=       37      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       41      if ind1990==    100     & ind1990!=.;
replace ShoreInd=       42      if ind1990==    101     & ind1990!=.;
replace ShoreInd=       43      if ind1990==    102     & ind1990!=.;
replace ShoreInd=       44      if ind1990==    110     & ind1990!=.;
replace ShoreInd=       45      if ind1990==    111     & ind1990!=.;
replace ShoreInd=       46      if ind1990==    112     & ind1990!=.;
replace ShoreInd=       47      if ind1990==    120     & ind1990!=.;
replace ShoreInd=       48      if ind1990==    130     & ind1990!=.;
replace ShoreInd=       49      if ind1990==    121     & ind1990!=.;
replace ShoreInd=       49      if ind1990==    122     & ind1990!=.;
replace ShoreInd=       50      if ind1990==    132     & ind1990!=.;
replace ShoreInd=       50      if ind1990==    140     & ind1990!=.;
replace ShoreInd=       50      if ind1990==    141     & ind1990!=.;
replace ShoreInd=       50      if ind1990==    142     & ind1990!=.;
replace ShoreInd=       50      if ind1990==    150     & ind1990!=.;
replace ShoreInd=       50      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       50      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       51      if ind1990==    151     & ind1990!=.;
replace ShoreInd=       51      if ind1990==    152     & ind1990!=.;
replace ShoreInd=       52      if ind1990==    160     & ind1990!=.;
replace ShoreInd=       52      if ind1990==    161     & ind1990!=.;
replace ShoreInd=       52      if ind1990==    162     & ind1990!=.;
replace ShoreInd=       53      if ind1990==    171     & ind1990!=.;
replace ShoreInd=       53      if ind1990==    172     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    192     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    180     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    212     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    181     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    182     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    190     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    191     & ind1990!=.;
replace ShoreInd=       54      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       54      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       55      if ind1990==    200     & ind1990!=.;
replace ShoreInd=       55      if ind1990==    201     & ind1990!=.;
replace ShoreInd=       56      if ind1990==    210     & ind1990!=.;
replace ShoreInd=       56      if ind1990==    211     & ind1990!=.;
replace ShoreInd=       57      if ind1990==    220     & ind1990!=.;
replace ShoreInd=       57      if ind1990==    221     & ind1990!=.;
replace ShoreInd=       57      if ind1990==    222     & ind1990!=.;
replace ShoreInd=       58      if ind1990==    390     & ind1990!=.;
replace ShoreInd=       58      if ind1990==    391     & ind1990!=.;
replace ShoreInd=       58      if ind1990==    392     & ind1990!=.;
replace ShoreInd=       58      if ind1990==    362     & ind1990!=.;
replace ShoreInd=       61      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       61      if ind1990==    400     & ind1990!=.;
replace ShoreInd=       62      if ind1990==    410     & ind1990!=.;
replace ShoreInd=       62      if ind1990==    411     & ind1990!=.;
replace ShoreInd=       63      if ind1990==    421     & ind1990!=.;
replace ShoreInd=       64      if ind1990==    420     & ind1990!=.;
replace ShoreInd=       65      if ind1990==    401     & ind1990!=.;
replace ShoreInd=       65      if ind1990==    402     & ind1990!=.;
replace ShoreInd=       66      if ind1990==    422     & ind1990!=.;
replace ShoreInd=       67      if ind1990==    432     & ind1990!=.;
replace ShoreInd=       68      if ind1990==    440     & ind1990!=.;
replace ShoreInd=       68      if ind1990==    441     & ind1990!=.;
replace ShoreInd=       68      if ind1990==    442     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    450     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    451     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    452     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    470     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    471     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    472     & ind1990!=.;
replace ShoreInd=       69      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       71      if ind1990==    500     & ind1990!=.;
replace ShoreInd=       72      if ind1990==    541     & ind1990!=.;
replace ShoreInd=       72      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       73      if ind1990==    501     & ind1990!=.;
replace ShoreInd=       73      if ind1990==    542     & ind1990!=.;
replace ShoreInd=       74      if ind1990==    550     & ind1990!=.;
replace ShoreInd=       75      if ind1990==    551     & ind1990!=.;
replace ShoreInd=       75      if ind1990==    561     & ind1990!=.;
replace ShoreInd=       76      if ind1990==    512     & ind1990!=.;
replace ShoreInd=       77      if ind1990==    521     & ind1990!=.;
replace ShoreInd=       78      if ind1990==    521     & ind1990!=.;
replace ShoreInd=       79      if ind1990==    510     & ind1990!=.;
replace ShoreInd=       79      if ind1990==    530     & ind1990!=.;
replace ShoreInd=       80      if ind1990==    511     & ind1990!=.;
replace ShoreInd=       81      if ind1990==    552     & ind1990!=.;
replace ShoreInd=       82      if ind1990==    531     & ind1990!=.;
replace ShoreInd=       83      if ind1990==    560     & ind1990!=.;
replace ShoreInd=       84      if ind1990==    540     & ind1990!=.;
replace ShoreInd=       85      if ind1990==    502     & ind1990!=.;
replace ShoreInd=       86      if ind1990==    532     & ind1990!=.;
replace ShoreInd=       86      if ind1990==    562     & ind1990!=.;
replace ShoreInd=       86      if ind1990==    571     & ind1990!=.;
replace ShoreInd=       86      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       86      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       86      if ind1990==    .       & ind1990!=.;
replace ShoreInd=       91      if ind1990==    580     & ind1990!=.;
replace ShoreInd=       91      if ind1990==    581     & ind1990!=.;
replace ShoreInd=       91      if ind1990==    582     & ind1990!=.;
replace ShoreInd=       92      if ind1990==    591     & ind1990!=.;
replace ShoreInd=       92      if ind1990==    592     & ind1990!=.;
replace ShoreInd=       92      if ind1990==    600     & ind1990!=.;
replace ShoreInd=       93      if ind1990==    601     & ind1990!=.;
replace ShoreInd=       93      if ind1990==    602     & ind1990!=.;
replace ShoreInd=       93      if ind1990==    610     & ind1990!=.;
replace ShoreInd=       93      if ind1990==    611     & ind1990!=.;
replace ShoreInd=       94      if ind1990==    650     & ind1990!=.;
replace ShoreInd=       95      if ind1990==    612     & ind1990!=.;
replace ShoreInd=       95      if ind1990==    620     & ind1990!=.;
replace ShoreInd=       95      if ind1990==    621     & ind1990!=.;
replace ShoreInd=       95      if ind1990==    590     & ind1990!=.;
replace ShoreInd=       95      if ind1990==    622     & ind1990!=.;
replace ShoreInd=       96      if ind1990==    623     & ind1990!=.;
replace ShoreInd=       96      if ind1990==    630     & ind1990!=.;
replace ShoreInd=       97      if ind1990==    631     & ind1990!=.;
replace ShoreInd=       97      if ind1990==    632     & ind1990!=.;
replace ShoreInd=       97      if ind1990==    633     & ind1990!=.;
replace ShoreInd=       98      if ind1990==    641     & ind1990!=.;
replace ShoreInd=       99      if ind1990==    642     & ind1990!=.;
replace ShoreInd=       100     if ind1990==    663     & ind1990!=.;
replace ShoreInd=       100     if ind1990==    670     & ind1990!=.;
replace ShoreInd=       100     if ind1990==    671     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    640     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    651     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    652     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    660     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    661     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    662     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    672     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    681     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    682     & ind1990!=.;
replace ShoreInd=       101     if ind1990==    691     & ind1990!=.;
replace ShoreInd=       102     if ind1990==    700     & ind1990!=.;
replace ShoreInd=       102     if ind1990==    701     & ind1990!=.;
replace ShoreInd=       103     if ind1990==    702     & ind1990!=.;
replace ShoreInd=       104     if ind1990==    710     & ind1990!=.;
replace ShoreInd=       105     if ind1990==    711     & ind1990!=.;
replace ShoreInd=       106     if ind1990==    712     & ind1990!=.;
replace ShoreInd=       107     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       111     if ind1990==    721     & ind1990!=.;
replace ShoreInd=       111     if ind1990==    722     & ind1990!=.;
replace ShoreInd=       111     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       111     if ind1990==    731     & ind1990!=.;
replace ShoreInd=       111     if ind1990==    732     & ind1990!=.;
replace ShoreInd=       111     if ind1990==    740     & ind1990!=.;
replace ShoreInd=       111     if ind1990==    741     & ind1990!=.;
replace ShoreInd=       111     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       112     if ind1990==    742     & ind1990!=.;
replace ShoreInd=       112     if ind1990==    750     & ind1990!=.;
replace ShoreInd=       112     if ind1990==    751     & ind1990!=.;
replace ShoreInd=       113     if ind1990==    752     & ind1990!=.;
replace ShoreInd=       113     if ind1990==    760     & ind1990!=.;
replace ShoreInd=       113     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       114     if ind1990==    761     & ind1990!=.;
replace ShoreInd=       115     if ind1990==    762     & ind1990!=.;
replace ShoreInd=       115     if ind1990==    770     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    771     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    772     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    780     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    782     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    790     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    791     & ind1990!=.;
replace ShoreInd=       116     if ind1990==    781     & ind1990!=.;
replace ShoreInd=       117     if ind1990==    800     & ind1990!=.;
replace ShoreInd=       117     if ind1990==    801     & ind1990!=.;
replace ShoreInd=       118     if ind1990==    802     & ind1990!=.;
replace ShoreInd=       118     if ind1990==    810     & ind1990!=.;
replace ShoreInd=       118     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       119     if ind1990==    812     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    820     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    821     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    822     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    830     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    831     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    832     & ind1990!=.;
replace ShoreInd=       119     if ind1990==    840     & ind1990!=.;
replace ShoreInd=       120     if ind1990==    841     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    842     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    850     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    851     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    852     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    860     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    861     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    862     & ind1990!=.;
replace ShoreInd=       121     if ind1990==    863     & ind1990!=.;
replace ShoreInd=       122     if ind1990==    872     & ind1990!=.;
replace ShoreInd=       123     if ind1990==    880     & ind1990!=.;
replace ShoreInd=       123     if ind1990==    870     & ind1990!=.;
replace ShoreInd=       123     if ind1990==    871     & ind1990!=.;
replace ShoreInd=       124     if ind1990==    881     & ind1990!=.;
replace ShoreInd=       124     if ind1990==    881     & ind1990!=.;
replace ShoreInd=       125     if ind1990==    882     & ind1990!=.;
replace ShoreInd=       125     if ind1990==    890     & ind1990!=.;
replace ShoreInd=       125     if ind1990==    891     & ind1990!=.;
replace ShoreInd=       126     if ind1990==    873     & ind1990!=.;
replace ShoreInd=       126     if ind1990==    892     & ind1990!=.;
replace ShoreInd=       126     if ind1990==    893     & ind1990!=.;
replace ShoreInd=       127     if ind1990==    412     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    900     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    901     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    910     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    921     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    922     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    930     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    931     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    932     & ind1990!=.;
replace ShoreInd=       128     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       128     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       129     if ind1990==    992     & ind1990!=.;
replace ShoreInd=       129     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       129     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       129     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       129     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       129     if ind1990==    .       & ind1990!=.;
replace ShoreInd=       129     if ind1990==    .       & ind1990!=.;


replace ShoreInd=       1       if ind1950==    105     & ind1950!=. & ind1990==.;
replace ShoreInd=       2       if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       2       if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       3       if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       3       if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       4       if ind1950==    116     & ind1950!=. & ind1990==.;
replace ShoreInd=       5       if ind1950==    126     & ind1950!=. & ind1990==.;
replace ShoreInd=       11      if ind1950==    206     & ind1950!=. & ind1990==.;
replace ShoreInd=       12      if ind1950==    216     & ind1950!=. & ind1990==.;
replace ShoreInd=       13      if ind1950==    226     & ind1950!=. & ind1990==.;
replace ShoreInd=       14      if ind1950==    236     & ind1950!=. & ind1990==.;
replace ShoreInd=       21      if ind1950==    246     & ind1950!=. & ind1990==.;
replace ShoreInd=       21      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       21      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       21      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       21      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       31      if ind1950==    306     & ind1950!=. & ind1990==.;
replace ShoreInd=       31      if ind1950==    307     & ind1950!=. & ind1990==.;
replace ShoreInd=       31      if ind1950==    308     & ind1950!=. & ind1990==.;
replace ShoreInd=       31      if ind1950==    309     & ind1950!=. & ind1990==.;
replace ShoreInd=       32      if ind1950==    316     & ind1950!=. & ind1990==.;
replace ShoreInd=       32      if ind1950==    317     & ind1950!=. & ind1990==.;
replace ShoreInd=       32      if ind1950==    318     & ind1950!=. & ind1990==.;
replace ShoreInd=       32      if ind1950==    319     & ind1950!=. & ind1990==.;
replace ShoreInd=       32      if ind1950==    326     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    336     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    337     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    338     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    346     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    347     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    348     & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       33      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    356     & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    357     & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    367     & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    358     & ind1950!=. & ind1990==.;
replace ShoreInd=       34      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       35      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       35      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       35      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       35      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       36      if ind1950==    376     & ind1950!=. & ind1990==.;
replace ShoreInd=       36      if ind1950==    377     & ind1950!=. & ind1990==.;
replace ShoreInd=       36      if ind1950==    378     & ind1950!=. & ind1990==.;
replace ShoreInd=       36      if ind1950==    379     & ind1950!=. & ind1990==.;
replace ShoreInd=       36      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       36      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       37      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       37      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       37      if ind1950==    387     & ind1950!=. & ind1990==.;
replace ShoreInd=       37      if ind1950==    388     & ind1950!=. & ind1990==.;
replace ShoreInd=       37      if ind1950==    386     & ind1950!=. & ind1990==.;
replace ShoreInd=       41      if ind1950==    406     & ind1950!=. & ind1990==.;
replace ShoreInd=       42      if ind1950==    407     & ind1950!=. & ind1990==.;
replace ShoreInd=       43      if ind1950==    408     & ind1950!=. & ind1990==.;
replace ShoreInd=       44      if ind1950==    409     & ind1950!=. & ind1990==.;
replace ShoreInd=       45      if ind1950==    416     & ind1950!=. & ind1990==.;
replace ShoreInd=       46      if ind1950==    417     & ind1950!=. & ind1990==.;
replace ShoreInd=       47      if ind1950==    418     & ind1950!=. & ind1990==.;
replace ShoreInd=       48      if ind1950==    429     & ind1950!=. & ind1990==.;
replace ShoreInd=       49      if ind1950==    419     & ind1950!=. & ind1990==.;
replace ShoreInd=       49      if ind1950==    426     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    429     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    436     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    437     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    438     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    439     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    446     & ind1950!=. & ind1990==.;
replace ShoreInd=       50      if ind1950==    466     & ind1950!=. & ind1990==.;
replace ShoreInd=       51      if ind1950==    448     & ind1950!=. & ind1990==.;
replace ShoreInd=       51      if ind1950==    449     & ind1950!=. & ind1990==.;
replace ShoreInd=       52      if ind1950==    456     & ind1950!=. & ind1990==.;
replace ShoreInd=       52      if ind1950==    457     & ind1950!=. & ind1990==.;
replace ShoreInd=       52      if ind1950==    458     & ind1950!=. & ind1990==.;
replace ShoreInd=       53      if ind1950==    459     & ind1950!=. & ind1990==.;
replace ShoreInd=       53      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    469     & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    477     & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    467     & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    468     & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       54      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       55      if ind1950==    476     & ind1950!=. & ind1990==.;
replace ShoreInd=       55      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       56      if ind1950==    478     & ind1950!=. & ind1990==.;
replace ShoreInd=       56      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       57      if ind1950==    487     & ind1950!=. & ind1990==.;
replace ShoreInd=       57      if ind1950==    488     & ind1950!=. & ind1990==.;
replace ShoreInd=       57      if ind1950==    489     & ind1950!=. & ind1990==.;
replace ShoreInd=       58      if ind1950==    499     & ind1950!=. & ind1990==.;
replace ShoreInd=       58      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       58      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       58      if ind1950==    399     & ind1950!=. & ind1990==.;
replace ShoreInd=       61      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       61      if ind1950==    506     & ind1950!=. & ind1990==.;
replace ShoreInd=       62      if ind1950==    526     & ind1950!=. & ind1990==.;
replace ShoreInd=       62      if ind1950==    527     & ind1950!=. & ind1990==.;
replace ShoreInd=       63      if ind1950==    556     & ind1950!=. & ind1990==.;
replace ShoreInd=       64      if ind1950==    546     & ind1950!=. & ind1990==.;
replace ShoreInd=       65      if ind1950==    516     & ind1950!=. & ind1990==.;
replace ShoreInd=       65      if ind1950==    536     & ind1950!=. & ind1990==.;
replace ShoreInd=       66      if ind1950==    567     & ind1950!=. & ind1990==.;
replace ShoreInd=       67      if ind1950==    568     & ind1950!=. & ind1990==.;
replace ShoreInd=       68      if ind1950==    578     & ind1950!=. & ind1990==.;
replace ShoreInd=       68      if ind1950==    579     & ind1950!=. & ind1990==.;
replace ShoreInd=       68      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    586     & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    587     & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    588     & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    596     & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    597     & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    598     & ind1950!=. & ind1990==.;
replace ShoreInd=       69      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       71      if ind1950==    606     & ind1950!=. & ind1990==.;
replace ShoreInd=       72      if ind1950==    607     & ind1950!=. & ind1990==.;
replace ShoreInd=       72      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       73      if ind1950==    608     & ind1950!=. & ind1990==.;
replace ShoreInd=       73      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       74      if ind1950==    609     & ind1950!=. & ind1990==.;
replace ShoreInd=       75      if ind1950==    619     & ind1950!=. & ind1990==.;
replace ShoreInd=       75      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       76      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       77      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       78      if ind1950==    616     & ind1950!=. & ind1990==.;
replace ShoreInd=       79      if ind1950==    617     & ind1950!=. & ind1990==.;
replace ShoreInd=       79      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       80      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       81      if ind1950==    618     & ind1950!=. & ind1990==.;
replace ShoreInd=       82      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       83      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       84      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       85      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       86      if ind1950==    626     & ind1950!=. & ind1990==.;
replace ShoreInd=       86      if ind1950==    627     & ind1950!=. & ind1990==.;
replace ShoreInd=       86      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       86      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       86      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       86      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       91      if ind1950==    686     & ind1950!=. & ind1990==.;
replace ShoreInd=       91      if ind1950==    687     & ind1950!=. & ind1990==.;
replace ShoreInd=       91      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       92      if ind1950==    646     & ind1950!=. & ind1990==.;
replace ShoreInd=       92      if ind1950==    647     & ind1950!=. & ind1990==.;
replace ShoreInd=       92      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       93      if ind1950==    636     & ind1950!=. & ind1990==.;
replace ShoreInd=       93      if ind1950==    637     & ind1950!=. & ind1990==.;
replace ShoreInd=       93      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       93      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       94      if ind1950==    688     & ind1950!=. & ind1990==.;
replace ShoreInd=       95      if ind1950==    667     & ind1950!=. & ind1990==.;
replace ShoreInd=       95      if ind1950==    668     & ind1950!=. & ind1990==.;
replace ShoreInd=       95      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       95      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       95      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       96      if ind1950==    656     & ind1950!=. & ind1990==.;
replace ShoreInd=       96      if ind1950==    657     & ind1950!=. & ind1990==.;
replace ShoreInd=       97      if ind1950==    658     & ind1950!=. & ind1990==.;
replace ShoreInd=       97      if ind1950==    659     & ind1950!=. & ind1990==.;
replace ShoreInd=       97      if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       98      if ind1950==    679     & ind1950!=. & ind1990==.;
replace ShoreInd=       99      if ind1950==    669     & ind1950!=. & ind1990==.;
replace ShoreInd=       100     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       100     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       100     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    696     & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    697     & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    689     & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    698     & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    699     & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       101     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       102     if ind1950==    716     & ind1950!=. & ind1990==.;
replace ShoreInd=       102     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       103     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       104     if ind1950==    726     & ind1950!=. & ind1990==.;
replace ShoreInd=       105     if ind1950==    736     & ind1950!=. & ind1990==.;
replace ShoreInd=       106     if ind1950==    746     & ind1950!=. & ind1990==.;
replace ShoreInd=       107     if ind1950==    756     & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    806     & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    807     & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    808     & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       111     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       112     if ind1950==    816     & ind1950!=. & ind1990==.;
replace ShoreInd=       112     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       112     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       113     if ind1950==    817     & ind1950!=. & ind1990==.;
replace ShoreInd=       113     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       113     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       114     if ind1950==    826     & ind1950!=. & ind1990==.;
replace ShoreInd=       115     if ind1950==    836     & ind1950!=. & ind1990==.;
replace ShoreInd=       115     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    846     & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    847     & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    848     & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    849     & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       116     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       117     if ind1950==    857     & ind1950!=. & ind1990==.;
replace ShoreInd=       117     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       118     if ind1950==    856     & ind1950!=. & ind1990==.;
replace ShoreInd=       118     if ind1950==    858     & ind1950!=. & ind1990==.;
replace ShoreInd=       118     if ind1950==    859     & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    868     & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    869     & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       119     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       120     if ind1950==    879     & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    888     & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       121     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       122     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       123     if ind1950==    896     & ind1950!=. & ind1990==.;
replace ShoreInd=       123     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       123     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       124     if ind1950==    897     & ind1950!=. & ind1990==.;
replace ShoreInd=       124     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       125     if ind1950==    898     & ind1950!=. & ind1990==.;
replace ShoreInd=       125     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       125     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       126     if ind1950==    899     & ind1950!=. & ind1990==.;
replace ShoreInd=       126     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       126     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       127     if ind1950==    906     & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    916     & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    926     & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    936     & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    946     & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       128     if ind1950==    .       & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    976     & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    982     & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    983     & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    984     & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    987     & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    991     & ind1950!=. & ind1990==.;
replace ShoreInd=       129     if ind1950==    239     & ind1950!=. & ind1990==.;

replace ShoreInd=. if (ind1990==0 & ind1950==0)| (ind1990==. & ind1950==.);

save "$startdir/$outputdata/ipumsindbasetemp.dta", replace;

use "$startdir/$outputdata/ipumsindbasetemp.dta";


label variable ShoreInd "Shore's standardized industry codes";
label define ShoreIndlblb       1       "       Agricultural Production Crops   ", add;
label define ShoreIndlblb       2       "       Agriculture production livestock and animal specialties ", add;
label define ShoreIndlblb       3       "       Agricultural Services   ", add;
label define ShoreIndlblb       4       "       Forestry        ", add;
label define ShoreIndlblb       5       "       Fishing, hunting, and trapping  ", add;
label define ShoreIndlblb       11      "       Metal mining    ", add;
label define ShoreIndlblb       12      "       Coal mining     ", add;
label define ShoreIndlblb       13      "       Crude petroleum and natural gas extractions     ", add;
label define ShoreIndlblb       14      "       Nonmetallic mining and quarrying, except fuel   ", add;
label define ShoreIndlblb       21      "       Construction    ", add;
label define ShoreIndlblb       31      "       Manufacturing, durable, Lumber and wood products        ", add;
label define ShoreIndlblb       32      "       Manufacturing, durable, Stone, Clay, Glass, And Concrete Products       ", add;
label define ShoreIndlblb       33      "       Manufacturing, durable, metal   ", add;
label define ShoreIndlblb       34      "       Manufacturing, durable, machinery       ", add;
label define ShoreIndlblb       35      "       Manufacturing, durable, electrical      ", add;
label define ShoreIndlblb       36      "       Manufacturing, durable, transportation equipment        ", add;
label define ShoreIndlblb       37      "       Manufacturing, durable, measurement equipment   ", add;
label define ShoreIndlblb       41      "       Manufacturing, nondurable, meat ", add;
label define ShoreIndlblb       42      "       Manufacturing, nondurable, dairy        ", add;
label define ShoreIndlblb       43      "       Manufacturing, nondurable, canned       ", add;
label define ShoreIndlblb       44      "       Manufacturing, nondurable, Grain-mill products                  ", add;
label define ShoreIndlblb       45      "       Manufacturing, nondurable, Bakery products                      ", add;
label define ShoreIndlblb       46      "       Manufacturing, nondurable, Confectionery and related products   ", add;
label define ShoreIndlblb       47      "       Manufacturing, nondurable, Beverage industries  ", add;
label define ShoreIndlblb       48      "       Manufacturing, nondurable, tobacco      ", add;
label define ShoreIndlblb       49      "       Manufacturing, nondurable, other food   ", add;
label define ShoreIndlblb       50      "       Manufacturing, textiles ", add;
label define ShoreIndlblb       51      "       Manufacturing, apparel  ", add;
label define ShoreIndlblb       52      "       Manufacturing, paper    ", add;
label define ShoreIndlblb       53      "       Manufacturing, printing ", add;
label define ShoreIndlblb       54      "       Manufacturing, chemicals        ", add;
label define ShoreIndlblb       55      "       Manufacturing, petroleum        ", add;
label define ShoreIndlblb       56      "       Manufacturing, rubber   ", add;
label define ShoreIndlblb       57      "       Manufacturing, leather  ", add;
label define ShoreIndlblb       58      "       Manufacturing, other    ", add;
label define ShoreIndlblb       61      "       Transportation, rail    ", add;
label define ShoreIndlblb       62      "       Transportation, trucking and storage    ", add;
label define ShoreIndlblb       63      "       Transportation, air     ", add;
label define ShoreIndlblb       64      "       Transportation, water   ", add;
label define ShoreIndlblb       65      "       Transportation, bus, taxi, public transit       ", add;
label define ShoreIndlblb       66      "       Transportation, pipelines       ", add;
label define ShoreIndlblb       67      "       Transportation, services        ", add;
label define ShoreIndlblb       68      "       Communications  ", add;
label define ShoreIndlblb       69      "       Utilities       ", add;
label define ShoreIndlblb       71      "       Wholesale, motor vehicles       ", add;
label define ShoreIndlblb       72      "       Wholesale, drugs and chemicals  ", add;
label define ShoreIndlblb       73      "       Wholesale, Dry goods and apparel                                                ", add;
label define ShoreIndlblb       74      "       Wholesale, Food and related products                                            ", add;
label define ShoreIndlblb       75      "       Wholesale, Farm products--raw materials                                         ", add;
label define ShoreIndlblb       76      "       Wholesale, Electrical goods                                                     ", add;
label define ShoreIndlblb       77      "       Wholesale, Hardware, plumbing, and heating supplies                             ", add;
label define ShoreIndlblb       78      "       Wholesale, Electrical and hardware products, n.s.                               ", add;
label define ShoreIndlblb       79      "       Wholesale, Machinery equipment and supplies                                     ", add;
label define ShoreIndlblb       80      "       Wholesale, Metals and minerals, n.e.c.                                          ", add;
label define ShoreIndlblb       81      "       Wholesale, Petroleum products                                                   ", add;
label define ShoreIndlblb       82      "       Wholesale, Scrap and waste materials                                            ", add;
label define ShoreIndlblb       83      "       Wholesale, Alcoholic beverages                                                  ", add;
label define ShoreIndlblb       84      "       Wholesale, Paper and its products                                               ", add;
label define ShoreIndlblb       85      "       Wholesale, Lumber and construction materials                                    ", add;
label define ShoreIndlblb       86      "       Wholesale, misc ", add;
label define ShoreIndlblb       91      "       Retail, hardware, lumber, and building  ", add;
label define ShoreIndlblb       92      "       Retail, department and general stores   ", add;
label define ShoreIndlblb       93      "       Retail, food    ", add;
label define ShoreIndlblb       94      "       Retail, liquor  ", add;
label define ShoreIndlblb       95      "       Retail, auto    ", add;
label define ShoreIndlblb       96      "       Retail, apparel ", add;
label define ShoreIndlblb       97      "       Retail, home furnishings        ", add;
label define ShoreIndlblb       98      "       Retail, restaurants and bars    ", add;
label define ShoreIndlblb       99      "       Retail, drug stores     ", add;
label define ShoreIndlblb       100     "       Retail, Nonstore Retailers      ", add;
label define ShoreIndlblb       101     "       Retail, other   ", add;
label define ShoreIndlblb       102     "       Finance, banks  ", add;
label define ShoreIndlblb       103     "       Finance, credit ", add;
label define ShoreIndlblb       104     "       Finance, securities, brokers, and dealers       ", add;
label define ShoreIndlblb       105     "       Finance, insurance      ", add;
label define ShoreIndlblb       106     "       Fiannce, real estate    ", add;
label define ShoreIndlblb       107     "       Finance, other  ", add;
label define ShoreIndlblb       111     "       Services, business      ", add;
label define ShoreIndlblb       112     "       Services, auto  ", add;
label define ShoreIndlblb       113     "       Services, repair        ", add;
label define ShoreIndlblb       114     "       Services, private household     ", add;
label define ShoreIndlblb       115     "       Services, lodging       ", add;
label define ShoreIndlblb       116     "       Services, personal      ", add;
label define ShoreIndlblb       117     "       Services, movies        ", add;
label define ShoreIndlblb       118     "       Services, non-movie entertainment       ", add;
label define ShoreIndlblb       119     "       Services, health        ", add;
label define ShoreIndlblb       120     "       Services, legal ", add;
label define ShoreIndlblb       121     "       Services, education     ", add;
label define ShoreIndlblb       122     "       Services, Museums, art galleries, and zoos              ", add;
label define ShoreIndlblb       123     "       Services, religious and social service  ", add;
label define ShoreIndlblb       124     "       Services, Membership Organizations      ", add;
label define ShoreIndlblb       125     "       Services, Engineering, Accounting, Research, Management, And Related Services           ", add;
label define ShoreIndlblb       126     "       Services, other ", add;
label define ShoreIndlblb       127     "       Services, postal        ", add;
label define ShoreIndlblb       128     "       Government      ", add;
label define ShoreIndlblb       129     "       unclassified workers or firms   ", add;

label values ShoreInd ShoreIndlbl;


save "$startdir/$outputdata/ipumsindbasetemp.dta", replace;


use "$startdir/$outputdata/ipumsindbasetemp.dta";

sort fips ShoreInd year;
collapse (sum) hhwt (count) Npeople=hhwt samestate, by(fips ShoreInd year);

label values fips statefiplbl;

save "$startdir/$outputdata/ipumsindbasestate.dta", replace;



local k=10;

forvalues i=1/`k'{;
        use "$startdir/$outputdata/ipumsindbasestate.dta";
        display(`i');
        replace year=year+`i';
        sort ShoreInd year;
        merge ShoreInd year using "$startdir/$outputdata/stockinddata.dta";
        keep if year-`i'==10*floor(year/10) | year-`i'==10*floor(year/10)-10;


        egen Nindustrieswpeople=seq() if hhwt!=. , by(fips ShoreInd year);
        egen Nindustrieswreturns=seq() if lnR!=., by(fips ShoreInd year);
        egen Nindustrieswpeopleandreturns=seq() if hhwt!=. & lnR!=., by(fips ShoreInd year);
        replace Nindustrieswpeople=0 if Nindustrieswpeople!=1;
        replace Nindustrieswreturns=0 if Nindustrieswreturns!=1;
        replace Nindustrieswpeopleandreturns=0 if Nindustrieswpeopleandreturns!=1;


        egen sumweight    =sum(hhwt) if lnR  !=. & ShoreInd!=. & hhwt!=., by(fips year);
        egen sumallweight =sum(hhwt) if            ShoreInd!=. & hhwt!=., by(fips year);
        gen sharecovered=sumweight/sumallweight;
        gen share  =hhwt/sumweight   if lnR  !=. & ShoreInd!=. & hhwt!=.;
        gen Rwt    =share  *exp(lnR )  if   ShoreInd!=. & hhwt!=.;
        gen betawt    =share  *beta  if   ShoreInd!=. & hhwt!=.;
        gen sewt    =share  *se  if   ShoreInd!=. & hhwt!=.;
        gen lnR2wt   =share  *lnR2  if   ShoreInd!=. & hhwt!=.;
        gen NpeoplewlnR=Npeople if share!=0 & share!=.;
        replace NpeoplewlnR=0 if share==0 | share==.;
        collapse   (sum) Nindustrieswpeople (sum) Nindustrieswreturns (sum) Nindustrieswpeopleandreturns
                   (sum) Nstocks (sum) Npeople  (sum) NpeoplewlnR   (mean) lnR2 =lnR2wt (sum) R =Rwt (sum) beta =betawt  (sum) se =sewt (mean)  sharecovered (mean) samestate, by(fips year);
        if `i'==1{;
                display("first round");
                save "$startdir/$outputdata/statereturns.dta", replace;
        };
        if `i'>1{;
                append using "$startdir/$outputdata/statereturns.dta";
                save "$startdir/$outputdata/statereturns.dta", replace;

        };

};
gen lnR=ln(R);
drop if fips==.;
drop if year>2008;
drop if year<1926;
label values fips statefiplbl;
save "$startdir/$outputdata/statereturns.dta", replace;


use "$startdir/$outputdata/ipumsindbasetemp.dta";

sort ShoreInd year;
collapse (sum) hhwt (count) Npeople=hhwt samestate, by(ShoreInd year);


save "$startdir/$outputdata/ipumsindbasenat.dta", replace;

local k=10;

forvalues i=1/`k'{;
        use "$startdir/$outputdata/ipumsindbasenat.dta";
        display(`i');
        replace year=year+`i';
        sort ShoreInd year;
        merge ShoreInd year using "$startdir/$outputdata/stockinddata.dta";
        keep if year-`i'==10*floor(year/10) | year-`i'==10*floor(year/10)-10;

        egen Nindustrieswpeople=seq() if hhwt!=. , by(ShoreInd year);
        egen Nindustrieswreturns=seq() if lnR!=., by(ShoreInd year);
        egen Nindustrieswpeopleandreturns=seq() if hhwt!=. & lnR!=., by(ShoreInd year);
        replace Nindustrieswpeople=0 if Nindustrieswpeople!=1;
        replace Nindustrieswreturns=0 if Nindustrieswreturns!=1;
        replace Nindustrieswpeopleandreturns=0 if Nindustrieswpeopleandreturns!=1;

        egen sumpeopleweight    =sum(hhwt) if lnR  !=. & ShoreInd!=. & hhwt!=., by(year);
        egen sumallpeopleweight =sum(hhwt) if            ShoreInd!=. & hhwt!=., by(year);
        gen sharepeoplecovered=sumpeopleweight/sumallpeopleweight;
        gen peopleshare  =hhwt/sumpeopleweight   if lnR  !=. & ShoreInd!=. & hhwt!=.;


        gen Rwtpeople      =peopleshare  *exp(lnR )  if   ShoreInd!=. & hhwt!=.;
        gen lnR2wtpeople   =peopleshare  *lnR2  if   ShoreInd!=. & hhwt!=.;
        gen NpeoplewlnR=Npeople if share!=0 & share!=.;
        replace NpeoplewlnR=0 if share==0 | share==.;

        egen sumcap = sum(mktcap) if lnR  !=., by(year);
        gen mktshare=mktcap/sumcap;
        gen Rwtmkt   =mktshare  *exp(lnR ) ;
        gen lnR2wtmkt      =mktshare  *lnR2  ;

        collapse   (sum) Nindustrieswpeople (sum) Nindustrieswreturns (sum) Nindustrieswpeopleandreturns
                   (sum) Nstocks
                   (mean) lnR2people =lnR2wtpeople      (sum) Rpeople =Rwtpeople
                   (mean) lnR2mkt =lnR2wtmkt            (sum) Rmkt =Rwtmkt
                   (mean) sharepeoplecovered (mean) samestate, by(year);

        if `i'==1{;
                display("first round");
                save "$startdir/$outputdata/natreturns.dta", replace;
        };
        if `i'>1{;
                append using "$startdir/$outputdata/natreturns.dta";
                save "$startdir/$outputdata/natreturns.dta", replace;
        };

};

gen lnRpeople=ln(Rpeople);
gen lnRmkt=ln(Rmkt);
drop if year>2008;
drop if year<1926;
save "$startdir/$outputdata/natreturns.dta", replace;


!erase "$startdir/$outputdata/ipumsindbasetemp.dta";
!erase "$startdir/$outputdata/ipumsindbasestate.dta";
!erase "$startdir/$outputdata/ipumsindbasenat.dta";



