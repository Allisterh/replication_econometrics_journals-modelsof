*one step paper 020817*organizational change estimatesclearset mem 500mset matsize 500install itsause "/Users/sulivan/Documents/Old Macbook Air/RNA/1s2s/JPR RandR/rna weeks 20170620.dta", cleartsset weekgen newbeth=0replace newbeth=1 if week==52******************** IDENTIFICATION FOR CONTROL SERIES 1 - EVENTS******************tsline event	* Looks to be some long term trend downward	tsline d1.event	* variance looks good dfuller event, trend regress 	* Z(t) is below critical intervals adn p-value is OK	* Trend stationary		dfuller event, regress 	* Z(t) is below critical intervals adn p-value is OK	* Stationary without the trendcorrgram  event	* Looks to be AR, potential MAac event	* AR process - Between 2 and 5 intervalspac event	* First Order - looks good******************** ESTIMATION FOR EVENTS******************* AR(2)arima event, arima(2,0,0)	estimates store event_AR2predict res_event_AR2, rescorrgram res_event_AR2 wntestq res_event_AR2 	*  White noise. Good!ac res_event_AR2	pac res_event_AR2 **** CONCLUSION: THE NUMBER OF EVENTS IS AN AR(2) PROCESS********************** IDENTIFICATION FOR CONTROL SERIES 2 - TOTAL IN ATTENDANCE******************tsline present	* Looks to no long term trend	tsline d1.present	* variance looks good dfuller present, trend regress 	* Z(t) is below critical intervals adn p-value is OK	* No trend is necessarycorrgram  present	* Looks to be white noise	ac present	* potentially an AR 3 processpac present	* potentially an AR 3 process******************** ESTIMATION FOR PRESENT******************* AR(3)arima present, arima(3,0,0)	estimates store present_AR3predict res_present_AR3, rescorrgram res_present_AR3wntestq res_present_AR3	*  White noise. Good!ac res_present_AR3	pac res_present_AR3**** CONCLUSION: THE NUMBER PRESENT IS AN AR(3) PROCESS************************************************************************************MODELS********************************************************************************* CONTROL MODEL 1 - EVENTS*********************** EVENTS is an AR(2)gen logevent=ln(event)arima event newbeth, arima(2, 0, 1) robustarima logevent newbeth, arima(2, 0, 0) robustarpois event newbeth, ar(2) delete prev robust****************CONTROL MODEL 2 - NUMBER PRESENT****************NUMBER PRESENT IS AN AR(3)gen logpresent=ln(present)arima present event newbeth, arima(2,0,2) robustarima logpresent newbeth, arima(2,0,0) robustarpois present event newbeth, ar(2) delete prev robust*******************Identification for org change vars - observable, unobservable, newloc, oldloc, orgchange************************************* IDENTIFICATION FOR Observable******************tsline observable	* Looks to be some long term trend downward	tsline d1.observable	* variance looks good dfuller observable, trend regress 	* Z(t) is below critical intervals adn p-value is OK	* Mean stationary	corrgram  observable	* Looks to be stochastic	ac observable	* potential AR 3 processpac observable	* Potential MA 3******************** ESTIMATION FOR EVENTS******************arima observable, arima(3,0,0)	estimates store observe_AR3predict res_observe_AR3, rescorrgram res_observe_AR3wntestq res_observe_AR3	*  White noise. Good!ac res_observe_AR3	pac res_observe_AR3**** CONCLUSION: THE NUMBER OF Observable EVENTS IS AN AR(3) PROCESS**********************************************************************************MODELS********************************************************************************* CONTROL MODEL 3 - Observeable EVENTS*********************** EVENTS is an AR(4)gen logevent=ln(event)arima observable newbeth event, arima(2, 0, 1) robustestimates store obsestforecast create for1, replaceforecast estimates obsestforecast exogenous newbethforecast solve, prefix(d_) begin(53) simulate(betas errors, statistic(stddev, prefix(sd_)) reps(100))gen ninetyfive=1.18*sd_observablegen ciminus=d_-ninetyfivegen ciplus=d_+ninetyfivetwoway (tsline d_observable) (tsline observable) (tsline ciplus) (tsline ciminus)arpois observable event newbeth, ar(2) delete prev robustarima unobservable newbeth postnbi event, arima(2, 0, 1) robustgen postnbi=0replace postnbi=1 if week>54gen tvar=postnbi*weekmargin, dydx (newbeth)arima unobservable newbeth postnbi tvar event, arima(2, 0, 1) robustpredict unobhatgen decay=0replace decay=week if week>52replace decay=decay-51replace decay=1/decaygen postnbi=0replace postnbi=1 if week>52gen decay2=0replace decay2=1 if week==53replace decay2=decay2[_n-1]+1 if week>53arima unobservable newbeth decay2 event week, arima(2, 0, 1) robustarpois unobservable event newbeth, ar(2) delete prev robustitsa unobservable  event, trperiod(53) single lag(1) figgen rat=unobservable/eventarima rat newbeth, arima(1,0, 0) robustgen prepost=.replace prepost=1 if week<52replace prepost=2 if week>52ttest event, by(prepost)ttest present, by(prepost)ttest observable, by(prepost)ttest unobservable, by(prepost)ttest orgchange, by(prepost)ttest oldloc, by(prepost)ttest newloc, by(prepost)arima orgchange newbeth event, arima(2,0, 1) robustarpois orgchange event newbeth, ar(2) delete prev robustarima oldloc newbeth event, arima(1,0, 0) robustarima newloc newbeth event, arima(2,0, 1) robustarpois newloc event newbeth, ar(2) delete prev robustgen per=newloc/eventarima per newbeth, arima(2,0,2) robustarima logevent newbeth, arima(2, 0, 0) robustarpois event newbeth, ar(1) delete prev robust	******************** MODEL ESTIMATION FOR EVENT SURVEILLANCE, NEWBETH AS A SINGLE SHOCK, WITH CONTROL FOR EVENTS******************** SURVEILLANCE is an AR(1) processarima  surveil  event newbeth, arima(1, 0, 0) robustarpois  surveil  event newbeth, ar(1) delete prev robust*var for single shock with IRF*var  surveil  event newbeth, lags(1) *irf create order1, set(surveil, replace) step(10) bsp reps(101)*irf graph irf, impulse(newbeth) response(surveil)******************** MODEL ESTIMATION FOR NUMBER IDENTIFIED, NEWBETH AS A SINGLE SHOCK, WITH CONTROL FOR NUMBER ATTENDED, NUMBER OF EVENTS******************** KNOWN_ATTENDEES is an AR(1) MA(1) processarima  known_attendees surveil event  present newbeth, arima(1, 0, 1) robustarpois  known_attendees surveil event present newbeth, ar(1) delete prev robust**to detrend, differencegen diff_attendees=D1.known_attendeesarima  known_attendees present total_ho newbeth, arima(1,0,0) robustpredict xb************************************models for hours invested****************************tsline total_ho	* looks stationarytsline d1.total_ho	* mean stationary, potentially cyclicaldfuller total_ho,trend regress 	* Looks good	* Z(t) within critical values and strong p-value	* nontrend stationarityycorrgram  total_ho	*looks to be an AR processs, potentially a MA processac total_ho	*looks like an AR2 processpac total_ho	* looks like a MA1 processs******************** ESTIMATION FOR total_ho - ******************* MODEL  Total_ho AR(2)MA(1)arima total_ho, arima(2,0,1)	estimates store totalAR2MA1	*none of the variables are significant.  * MODEL  total_ho AR(2)	arima total_ho, arima(2,0,0)	estimates store totalAR2	* Both the AR(2) are significantpredict res_totalAR2, rescorrgram res_totalAR2	wntestq res_totalAR2	*  White noise. Good good ac res_totalAR2	* coolpac res_totalAR2	* cool**** CONCLUSION: Total Hours IS AN AR(1) PROCESS*****************model for total hoursarima  total_ho   newbeth, arima(1, 0, 0) robustarpois  total_ho  newbeth, ar(1) delete prev robust*******************************robustness check - control for number of hours survielance******************************arima  surveil event total_ho newbeth, arima(1, 0, 0) robustarpois  surveil event total_ho newbeth, ar(1) delete prev robustarima  known_attendees present surveil event total_ho newbeth, arima(1, 0, 1) robustarpois  known_attendees present surveil event total_ho newbeth, ar(1) delete prev robustgen postnbi=0replace postnbi=1 if week>54arima  known_attendees present surveil event total_ho newbeth postnbi, arima(1, 0, 1) robust